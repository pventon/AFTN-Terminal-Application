\hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage}{}\doxysection{Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message Class Reference}
\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage}\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8e7acae0f2d8586a53ca28d0906cdfa2}{consistency\+\_\+check}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af705ae842f865c83ab40ba6addc58d07}{consistency\+\_\+check\+\_\+pbn}} (self, flight\+\_\+plan\+\_\+record, f10a)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ae34196ff16405fd6669509479994b974}{consistency\+\_\+check\+\_\+f9b\+\_\+dep}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af754e93999ff99cf471d6aee3edf497e}{consistency\+\_\+check\+\_\+f10a\+\_\+r}} (self, flight\+\_\+plan\+\_\+record, f10a)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a047e8a0178e389d469b5ec45b1f89247}{consistency\+\_\+check\+\_\+f10a\+\_\+z}} (self, flight\+\_\+plan\+\_\+record, f10a)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a59e21bdcd3a838fa623a417b99beebe4}{consistency\+\_\+check\+\_\+f13a\+\_\+dep}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a57b254954df042e2d8436d5f4ce3d969}{consistency\+\_\+check\+\_\+f16a\+\_\+dep}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aed74bf7dacf414e42fcc3cf986144622}{consistency\+\_\+check\+\_\+flight\+\_\+rules}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8ffdc5ea4ecfbb79a082f35c4c1e70e6}{get\+\_\+message\+\_\+description}} (self, flight\+\_\+plan\+\_\+record, message\+\_\+title)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a326beef3299b89e57c48486a583f87fb}{is\+\_\+message\+\_\+valid}} (self, flight\+\_\+plan\+\_\+record, message)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a69c45ea4ce8af8d8423e742b2fb56a2e}{parse\+\_\+adexp}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a3cd41e750952a99f3e9fe4df0cd636c3}{parse\+\_\+ats}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a13fbcfdb57c18c5e51ebaef3a475191f}{parse\+\_\+oldi}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a1fe4ca0885654f150bf398edaa51117c}{parse\+\_\+ats\+\_\+header}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a38060cf90756eae4635b7ec2a1370979}{parse\+\_\+ats\+\_\+or\+\_\+oldi}} (self, flight\+\_\+plan\+\_\+record, tokens, message\+\_\+title)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a97e87f0925994a34e7b4d3683dc56722}{parse\+\_\+message}} (self, flight\+\_\+plan\+\_\+record, message)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a61af25fe26dae1209cdd46e8a31fc0ef}{set\+\_\+message\+\_\+body\+\_\+and\+\_\+header}} (self, flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aff3ad13bc6a6afb7aeeb8e3761e8061e}{set\+\_\+message\+\_\+type}} (self, flight\+\_\+plan\+\_\+record)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a4d4602457890a1637bd59d62c54861af}{correct\+\_\+ers\+\_\+indices}} (flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a5965b24538807e17988e75ffbf3d2e93}{determine\+\_\+message\+\_\+type}} (f3)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8649c4435e0efea774a2a2e8139b9cf2}{parse\+\_\+oldi\+\_\+header}} (flight\+\_\+plan\+\_\+record)
\item 
def \mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0e3dc036d0345524348c5144b438055d}{tokenize\+\_\+message}} (flight\+\_\+plan\+\_\+record, whitespace)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a92f2c99a719bd6a23f3ca2755f576641}{int}}
\item 
\mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0979c9d10b2856a1a424965c14898e8e}{Fields\+In\+Message}}
\item 
\mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8c65544aeab4f892da49ca1d4bd617fb}{Sub\+Fields\+In\+Fields}}
\item 
\mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a64bd0c972c9e1e5a9ab6c765f770c05b}{Sub\+Field\+Descriptions}}
\item 
\mbox{\hyperlink{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ac9f430a4912db205f3371bd0561b4b39}{Error\+Messages}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}This class is the entry point for parsing complete ICAO format messages for both ATS and OLDI
messages. The parser is able to automatically evaluate if a message contains a header or not. For
ICAO ATS messages the data definitions are set up as a single data set; for OLDI messages the
definitions vary depending on an adjacent unit sending identifier.

The entry point method is 'parse_message()' that takes an instance of FlightPlanRecord and a
string containing the message to parse. The FlightPlanRecord is populated by the parser and
includes all extracted fields, an extracted route (if field 15 is present) and any errors. It
is a callers responsibility to retrieve the errors.

If this software is used in conjunction with a GUI, all the fields are stored with their zero
based index into the message so that erroneous fields can be highlighted in the GUI. This makes
message correction quite simple for end users.

Note: Eventually this parser will also support ADEXP message parsing; currently an error is reported
when an ADEXP message is encountered.

This class is thread safe and can be used simultaneously on multiple threads. This class includes
the message field list definitions (the configuration data for the parser) by instantiating the
MessageDescriptions class and assigning this the MCD member of this class.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8e7acae0f2d8586a53ca28d0906cdfa2}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8e7acae0f2d8586a53ca28d0906cdfa2}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check@{consistency\_check}}
\index{consistency\_check@{consistency\_check}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check()}{consistency\_check()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method performs consistency checking between various fields, that includes:
    - Flight rules between F8a and the flight rules derived by the F15 parsing and route
      extraction process; these must match.
    - If F10a contains the letter 'Z' then one or more of the F18 subfields
      'COM', 'NAV' or 'DAT' must be present;
    - If F10a contains the letter 'R' then the F18 'PBN' subfield must be present and
      contain one or more of the indicators 'B1', 'B2', 'B3', 'B4' or 'B5';
    - If F18 contains the subfield 'PBN', F10a must contain an 'R';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',
      'D2', 'O1' or 'O2', then F10a must contain the letter 'G';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',
      'D3', 'O1' or 'O3', then F10a must contain the letter 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must
      contain either an 'O' or 'S' and a 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',
      'D4', 'O1' or 'O4', then F10a must contain the letter 'I';
    - If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'
      or 'O4', then F10a must contain the letter 'D';

These consistency checks are only carried out on message titles defined to contain both field 10
and field 18, and/or field 8 and 15. These messages are:
    - AFP
    - ALR
    - APL
    - CPL
    - FPL

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{64     \textcolor{keyword}{def }consistency\_check(self, flight\_plan\_record):}
\DoxyCodeLine{65         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{66         \textcolor{stringliteral}{"""This method performs consistency checking between various fields, that includes:}}
\DoxyCodeLine{67 \textcolor{stringliteral}{            -\/ Flight rules between F8a and the flight rules derived by the F15 parsing and route}}
\DoxyCodeLine{68 \textcolor{stringliteral}{              extraction process; these must match.}}
\DoxyCodeLine{69 \textcolor{stringliteral}{            -\/ If F10a contains the letter 'Z' then one or more of the F18 subfields}}
\DoxyCodeLine{70 \textcolor{stringliteral}{              'COM', 'NAV' or 'DAT' must be present;}}
\DoxyCodeLine{71 \textcolor{stringliteral}{            -\/ If F10a contains the letter 'R' then the F18 'PBN' subfield must be present and}}
\DoxyCodeLine{72 \textcolor{stringliteral}{              contain one or more of the indicators 'B1', 'B2', 'B3', 'B4' or 'B5';}}
\DoxyCodeLine{73 \textcolor{stringliteral}{            -\/ If F18 contains the subfield 'PBN', F10a must contain an 'R';}}
\DoxyCodeLine{74 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',}}
\DoxyCodeLine{75 \textcolor{stringliteral}{              'D2', 'O1' or 'O2', then F10a must contain the letter 'G';}}
\DoxyCodeLine{76 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',}}
\DoxyCodeLine{77 \textcolor{stringliteral}{              'D3', 'O1' or 'O3', then F10a must contain the letter 'D';}}
\DoxyCodeLine{78 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must}}
\DoxyCodeLine{79 \textcolor{stringliteral}{              contain either an 'O' or 'S' and a 'D';}}
\DoxyCodeLine{80 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',}}
\DoxyCodeLine{81 \textcolor{stringliteral}{              'D4', 'O1' or 'O4', then F10a must contain the letter 'I';}}
\DoxyCodeLine{82 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'}}
\DoxyCodeLine{83 \textcolor{stringliteral}{              or 'O4', then F10a must contain the letter 'D';}}
\DoxyCodeLine{84 \textcolor{stringliteral}{}}
\DoxyCodeLine{85 \textcolor{stringliteral}{        These consistency checks are only carried out on message titles defined to contain both field 10}}
\DoxyCodeLine{86 \textcolor{stringliteral}{        and field 18, and/or field 8 and 15. These messages are:}}
\DoxyCodeLine{87 \textcolor{stringliteral}{            -\/ AFP}}
\DoxyCodeLine{88 \textcolor{stringliteral}{            -\/ ALR}}
\DoxyCodeLine{89 \textcolor{stringliteral}{            -\/ APL}}
\DoxyCodeLine{90 \textcolor{stringliteral}{            -\/ CPL}}
\DoxyCodeLine{91 \textcolor{stringliteral}{            -\/ FPL}}
\DoxyCodeLine{92 \textcolor{stringliteral}{}}
\DoxyCodeLine{93 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{94 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{95 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{96         \textcolor{keywordflow}{if} flight\_plan\_record.get\_message\_title() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} MessageTitles.AFP \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{97                 flight\_plan\_record.get\_message\_title() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} MessageTitles.ALR \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{98                 flight\_plan\_record.get\_message\_title() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} MessageTitles.APL \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{99                 flight\_plan\_record.get\_message\_title() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} MessageTitles.CPL \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{100                 flight\_plan\_record.get\_message\_title() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} MessageTitles.FPL:}
\DoxyCodeLine{101             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103         \textcolor{comment}{\# Consistency check the flight rules in F8a and those derived from F15}}
\DoxyCodeLine{104         result1: bool = self.consistency\_check\_flight\_rules(flight\_plan\_record)}
\DoxyCodeLine{105 }
\DoxyCodeLine{106         \textcolor{comment}{\# Check if the flight plan contains f10}}
\DoxyCodeLine{107         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F10) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{108             \textcolor{keywordflow}{return} result1}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         \textcolor{comment}{\# Get field 10a}}
\DoxyCodeLine{111         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F10, SubFieldIdentifiers.F10a) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{112             f10a = \textcolor{stringliteral}{""}}
\DoxyCodeLine{113         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{114             f10a = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F10, SubFieldIdentifiers.F10a).get\_field\_text()}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{comment}{\# Check various field 10 consistency checks}}
\DoxyCodeLine{117         result2 = self.consistency\_check\_f10a\_r(flight\_plan\_record, f10a)}
\DoxyCodeLine{118         result3 = self.consistency\_check\_f10a\_z(flight\_plan\_record, f10a)}
\DoxyCodeLine{119         result4 = self.consistency\_check\_pbn(flight\_plan\_record, f10a)}
\DoxyCodeLine{120         result5 = self.consistency\_check\_f9b\_dep(flight\_plan\_record)}
\DoxyCodeLine{121         result6 = self.consistency\_check\_f13a\_dep(flight\_plan\_record)}
\DoxyCodeLine{122         result7 = self.consistency\_check\_f16a\_dep(flight\_plan\_record)}
\DoxyCodeLine{123 }
\DoxyCodeLine{124         \textcolor{keywordflow}{return} result1 \textcolor{keywordflow}{or} result2 \textcolor{keywordflow}{or} result3 \textcolor{keywordflow}{or} result4 \textcolor{keywordflow}{or} result5 \textcolor{keywordflow}{or} result6 \textcolor{keywordflow}{or} result7}
\DoxyCodeLine{125 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af754e93999ff99cf471d6aee3edf497e}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af754e93999ff99cf471d6aee3edf497e}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_f10a\_r@{consistency\_check\_f10a\_r}}
\index{consistency\_check\_f10a\_r@{consistency\_check\_f10a\_r}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_f10a\_r()}{consistency\_check\_f10a\_r()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+f10a\+\_\+r (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{f10a }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that if F10a contains the letter 'R' then the F18
'PBN' subfield must be present and contain one or more of the indicators
'B1', 'B2', 'B3', 'B4' or 'B5';;

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{211     \textcolor{keyword}{def }consistency\_check\_f10a\_r(self, flight\_plan\_record, f10a):}
\DoxyCodeLine{212         \textcolor{comment}{\# type: (FlightPlanRecord, str) -\/> bool}}
\DoxyCodeLine{213         \textcolor{stringliteral}{"""This method consistency checks that if F10a contains the letter 'R' then the F18}}
\DoxyCodeLine{214 \textcolor{stringliteral}{        'PBN' subfield must be present and contain one or more of the indicators}}
\DoxyCodeLine{215 \textcolor{stringliteral}{        'B1', 'B2', 'B3', 'B4' or 'B5';;}}
\DoxyCodeLine{216 \textcolor{stringliteral}{}}
\DoxyCodeLine{217 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{218 \textcolor{stringliteral}{        :param f10a: The contents of field 10a;}}
\DoxyCodeLine{219 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{220 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{221         \textcolor{comment}{\# Check if field 10a contains an 'Z'}}
\DoxyCodeLine{222         \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"Z"}) > -\/1:}
\DoxyCodeLine{223             \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18com) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{224                     flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18nav) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} \(\backslash\)}
\DoxyCodeLine{225                     flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dat) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{226                 \textcolor{comment}{\# Missing field 18 subfields, error}}
\DoxyCodeLine{227                 Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'COM', 'NAV' or 'DAT'"}, 0, 0,}
\DoxyCodeLine{228                                 self.EM, ErrorId.CONSISTENCY\_F10\_Z)}
\DoxyCodeLine{229                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{230 }
\DoxyCodeLine{231         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{232 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a047e8a0178e389d469b5ec45b1f89247}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a047e8a0178e389d469b5ec45b1f89247}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_f10a\_z@{consistency\_check\_f10a\_z}}
\index{consistency\_check\_f10a\_z@{consistency\_check\_f10a\_z}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_f10a\_z()}{consistency\_check\_f10a\_z()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+f10a\+\_\+z (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{f10a }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that if F10a contains the letter 'Z' then one or
more of the F18 subfields 'COM', 'NAV' or 'DAT' must be present;

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{233     \textcolor{keyword}{def }consistency\_check\_f10a\_z(self, flight\_plan\_record, f10a):}
\DoxyCodeLine{234         \textcolor{comment}{\# type: (FlightPlanRecord, str) -\/> bool}}
\DoxyCodeLine{235         \textcolor{stringliteral}{"""This method consistency checks that if F10a contains the letter 'Z' then one or}}
\DoxyCodeLine{236 \textcolor{stringliteral}{        more of the F18 subfields 'COM', 'NAV' or 'DAT' must be present;}}
\DoxyCodeLine{237 \textcolor{stringliteral}{}}
\DoxyCodeLine{238 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{239 \textcolor{stringliteral}{        :param f10a: The contents of field 10a;}}
\DoxyCodeLine{240 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{241 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{242         \textcolor{comment}{\# Check if field 10a contains an 'R'}}
\DoxyCodeLine{243         \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"R"}) > -\/1:}
\DoxyCodeLine{244             pbn = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18pbn)}
\DoxyCodeLine{245             \textcolor{keywordflow}{if} pbn \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{246                 \textcolor{comment}{\# Missing field 18 PBN subfield, error}}
\DoxyCodeLine{247                 Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_F10\_R)}
\DoxyCodeLine{248                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{249             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{250                 \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B[1-\/5]"}, pbn.get\_field\_text())) == 0:}
\DoxyCodeLine{251                     \textcolor{comment}{\# Missing field 18 PBN B[1-\/5] indicators, error}}
\DoxyCodeLine{252                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_F10\_R)}
\DoxyCodeLine{253                     \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{256 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a59e21bdcd3a838fa623a417b99beebe4}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a59e21bdcd3a838fa623a417b99beebe4}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_f13a\_dep@{consistency\_check\_f13a\_dep}}
\index{consistency\_check\_f13a\_dep@{consistency\_check\_f13a\_dep}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_f13a\_dep()}{consistency\_check\_f13a\_dep()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+f13a\+\_\+dep (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that if F13a contains 'ZZZZ' that there is
a field 18 DEP subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{257     \textcolor{keyword}{def }consistency\_check\_f13a\_dep(self, flight\_plan\_record):}
\DoxyCodeLine{258         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{259         \textcolor{stringliteral}{"""This method consistency checks that if F13a contains 'ZZZZ' that there is}}
\DoxyCodeLine{260 \textcolor{stringliteral}{        a field 18 DEP subfield;}}
\DoxyCodeLine{261 \textcolor{stringliteral}{}}
\DoxyCodeLine{262 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{263 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{264 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{265         \textcolor{comment}{\# Check if the flight plan contains f13}}
\DoxyCodeLine{266         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F13) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{267             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269         \textcolor{comment}{\# Get field 13a}}
\DoxyCodeLine{270         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F13, SubFieldIdentifiers.F13a) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{271             f13a = \textcolor{stringliteral}{""}}
\DoxyCodeLine{272         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{273             f13a = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F13, SubFieldIdentifiers.F13a).get\_field\_text()}
\DoxyCodeLine{274 }
\DoxyCodeLine{275         \textcolor{comment}{\# Check if field 13a contains an 'ZZZZ'}}
\DoxyCodeLine{276         \textcolor{keywordflow}{if} f13a == \textcolor{stringliteral}{"ZZZZ"}:}
\DoxyCodeLine{277             \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dep) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{278                 \textcolor{comment}{\# Missing field 18 subfield DEP, error}}
\DoxyCodeLine{279                 Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{""}, 0, 0,}
\DoxyCodeLine{280                                 self.EM, ErrorId.CONSISTENCY\_F13A\_DEP)}
\DoxyCodeLine{281                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{284 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a57b254954df042e2d8436d5f4ce3d969}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a57b254954df042e2d8436d5f4ce3d969}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_f16a\_dep@{consistency\_check\_f16a\_dep}}
\index{consistency\_check\_f16a\_dep@{consistency\_check\_f16a\_dep}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_f16a\_dep()}{consistency\_check\_f16a\_dep()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+f16a\+\_\+dep (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that if F16a contains 'ZZZZ' that there is
a field 18 DEST subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{285     \textcolor{keyword}{def }consistency\_check\_f16a\_dep(self, flight\_plan\_record):}
\DoxyCodeLine{286         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{287         \textcolor{stringliteral}{"""This method consistency checks that if F16a contains 'ZZZZ' that there is}}
\DoxyCodeLine{288 \textcolor{stringliteral}{        a field 18 DEST subfield;}}
\DoxyCodeLine{289 \textcolor{stringliteral}{}}
\DoxyCodeLine{290 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{291 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{292 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{293         \textcolor{comment}{\# Check if the flight plan contains f16}}
\DoxyCodeLine{294         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F16) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{295             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{296 }
\DoxyCodeLine{297         \textcolor{comment}{\# Get field 16a}}
\DoxyCodeLine{298         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F16, SubFieldIdentifiers.F16a) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{299             f16a = \textcolor{stringliteral}{""}}
\DoxyCodeLine{300         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{301             f16a = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F16, SubFieldIdentifiers.F16a).get\_field\_text()}
\DoxyCodeLine{302 }
\DoxyCodeLine{303         \textcolor{comment}{\# Check if field 16a contains an 'ZZZZ'}}
\DoxyCodeLine{304         \textcolor{keywordflow}{if} f16a == \textcolor{stringliteral}{"ZZZZ"}:}
\DoxyCodeLine{305             \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dest) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{306                 \textcolor{comment}{\# Missing field 18 subfield DEST, error}}
\DoxyCodeLine{307                 Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{""}, 0, 0,}
\DoxyCodeLine{308                                 self.EM, ErrorId.CONSISTENCY\_F16A\_DEST)}
\DoxyCodeLine{309                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{310 }
\DoxyCodeLine{311         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{312 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ae34196ff16405fd6669509479994b974}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ae34196ff16405fd6669509479994b974}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_f9b\_dep@{consistency\_check\_f9b\_dep}}
\index{consistency\_check\_f9b\_dep@{consistency\_check\_f9b\_dep}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_f9b\_dep()}{consistency\_check\_f9b\_dep()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+f9b\+\_\+dep (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that if F9b contains 'ZZZZ' that there is
a field 18 TYP subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{184     \textcolor{keyword}{def }consistency\_check\_f9b\_dep(self, flight\_plan\_record):}
\DoxyCodeLine{185         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{186         \textcolor{stringliteral}{"""This method consistency checks that if F9b contains 'ZZZZ' that there is}}
\DoxyCodeLine{187 \textcolor{stringliteral}{        a field 18 TYP subfield;}}
\DoxyCodeLine{188 \textcolor{stringliteral}{}}
\DoxyCodeLine{189 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{190 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{191 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{192         \textcolor{comment}{\# Check if the flight plan contains f9}}
\DoxyCodeLine{193         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F9) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{194             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196         \textcolor{comment}{\# Get field 9b}}
\DoxyCodeLine{197         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F9, SubFieldIdentifiers.F9b) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{198             f9b = \textcolor{stringliteral}{""}}
\DoxyCodeLine{199         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{200             f9b = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F9, SubFieldIdentifiers.F9b).get\_field\_text()}
\DoxyCodeLine{201 }
\DoxyCodeLine{202         \textcolor{comment}{\# Check if field 9b contains 'ZZZZ'}}
\DoxyCodeLine{203         \textcolor{keywordflow}{if} f9b == \textcolor{stringliteral}{"ZZZZ"}:}
\DoxyCodeLine{204             \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18typ) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{205                 \textcolor{comment}{\# Missing field 18 subfield TYP, error}}
\DoxyCodeLine{206                 Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{""}, 0, 0, self.EM, ErrorId.CONSISTENCY\_F9B\_TYP)}
\DoxyCodeLine{207                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{210 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aed74bf7dacf414e42fcc3cf986144622}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aed74bf7dacf414e42fcc3cf986144622}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_flight\_rules@{consistency\_check\_flight\_rules}}
\index{consistency\_check\_flight\_rules@{consistency\_check\_flight\_rules}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_flight\_rules()}{consistency\_check\_flight\_rules()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+flight\+\_\+rules (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks the flight rules given in Field 8a and
the rules derived from parsing and generated the extracted route from F15.

:param flight_plan_record: Flight plan record used for checking the flight rules consistency;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{313     \textcolor{keyword}{def }consistency\_check\_flight\_rules(self, flight\_plan\_record):}
\DoxyCodeLine{314         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{315         \textcolor{stringliteral}{"""This method consistency checks the flight rules given in Field 8a and}}
\DoxyCodeLine{316 \textcolor{stringliteral}{        the rules derived from parsing and generated the extracted route from F15.}}
\DoxyCodeLine{317 \textcolor{stringliteral}{}}
\DoxyCodeLine{318 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking the flight rules consistency;}}
\DoxyCodeLine{319 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{320 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{321         \textcolor{comment}{\# If there is no extracted route bail out}}
\DoxyCodeLine{322         \textcolor{keywordflow}{if} flight\_plan\_record.get\_extracted\_route() \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{323             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{324 }
\DoxyCodeLine{325         \textcolor{comment}{\# Get the derived flight rules from the extracted route and set the derived rules}}
\DoxyCodeLine{326         \textcolor{comment}{\# to the flight plan record}}
\DoxyCodeLine{327         flight\_plan\_record.set\_derived\_flight\_rules(}
\DoxyCodeLine{328             FlightRules.get\_flight\_rules(}
\DoxyCodeLine{329                 flight\_plan\_record.get\_extracted\_route().get\_derived\_flight\_rules()))}
\DoxyCodeLine{330 }
\DoxyCodeLine{331         \textcolor{comment}{\# Get the flight rules from field 8}}
\DoxyCodeLine{332         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F8, SubFieldIdentifiers.F8a) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{333             f8a = \textcolor{stringliteral}{""}}
\DoxyCodeLine{334         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{335             f8a = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F8, SubFieldIdentifiers.F8a).get\_field\_text()}
\DoxyCodeLine{336 }
\DoxyCodeLine{337         \textcolor{comment}{\# Get the derived flight rules}}
\DoxyCodeLine{338         derived\_rules = flight\_plan\_record.get\_derived\_flight\_rules()}
\DoxyCodeLine{339         \textcolor{keywordflow}{if} f8a == \textcolor{stringliteral}{""}:}
\DoxyCodeLine{340             \textcolor{keywordflow}{if} derived\_rules \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} FlightRules.UNKNOWN:}
\DoxyCodeLine{341                 \textcolor{comment}{\# Error, derived rules exist, nothing in Field 8a}}
\DoxyCodeLine{342                 Utils.add\_error(flight\_plan\_record, derived\_rules.name, 0, 0,}
\DoxyCodeLine{343                                 self.EM, ErrorId.CONSISTENCY\_F8\_F8A\_UNKNOWN)}
\DoxyCodeLine{344                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{345         \textcolor{keywordflow}{elif} derived\_rules \textcolor{keywordflow}{is} FlightRules.UNKNOWN:}
\DoxyCodeLine{346             \textcolor{keywordflow}{if} f8a != \textcolor{stringliteral}{""}:}
\DoxyCodeLine{347                 \textcolor{comment}{\# Error, derived rules unknown but Field 8a has a rule assigned}}
\DoxyCodeLine{348                 Utils.add\_error(flight\_plan\_record, f8a, 0, 0,}
\DoxyCodeLine{349                                 self.EM, ErrorId.CONSISTENCY\_F8\_DERIVED\_UNKNOWN)}
\DoxyCodeLine{350                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{351         \textcolor{keywordflow}{elif} FlightRules.get\_flight\_rules(f8a) \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} derived\_rules:}
\DoxyCodeLine{352             \textcolor{comment}{\# Error, both flight rules available but different}}
\DoxyCodeLine{353             Utils.add\_error(flight\_plan\_record, derived\_rules.name, 0, 0,}
\DoxyCodeLine{354                             self.EM, ErrorId.CONSISTENCY\_F8\_F8\_DERIVED\_DIFFERENT)}
\DoxyCodeLine{355             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{356 }
\DoxyCodeLine{357         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{358 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af705ae842f865c83ab40ba6addc58d07}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_af705ae842f865c83ab40ba6addc58d07}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!consistency\_check\_pbn@{consistency\_check\_pbn}}
\index{consistency\_check\_pbn@{consistency\_check\_pbn}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{consistency\_check\_pbn()}{consistency\_check\_pbn()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+consistency\+\_\+check\+\_\+pbn (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{f10a }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consistency checks that one of the following dealing with the field
18 PBN subfield:
    - If F18 contains the subfield 'PBN', F10a must contain an 'R';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',
      'D2', 'O1' or 'O2', then F10a must contain the letter 'G';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',
      'D3', 'O1' or 'O3', then F10a must contain the letter 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must
      contain either an O' or 'S' and a 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',
      'D4', 'O1' or 'O4', then F10a must contain the letter 'I';
    - If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'
      or 'O4', then F10a must contain the letter 'D';
Another way to simplify the logic is to use a table to identify the permutations:
     | B1| B2| B3| B4| B5| C1| C2| C3| C4| D1| D2| D3| D4| O1| O2| O3| O4|
  D  | X |   | X | X |   | X |   | X | X | X |   | X | X | X |   | X | X |
  G  | X | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   |
  I  | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   | X |
 O|S | X |   |   | X |   |   |   |   |   |   |   |   |   |   |   |   |   |
  R  | X | X | X | X | X |   |   |   |   |   |   |   |   |   |   |   |   |

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{126     \textcolor{keyword}{def }consistency\_check\_pbn(self, flight\_plan\_record, f10a):}
\DoxyCodeLine{127         \textcolor{comment}{\# type: (FlightPlanRecord, str) -\/> bool}}
\DoxyCodeLine{128         \textcolor{stringliteral}{"""This method consistency checks that one of the following dealing with the field}}
\DoxyCodeLine{129 \textcolor{stringliteral}{        18 PBN subfield:}}
\DoxyCodeLine{130 \textcolor{stringliteral}{            -\/ If F18 contains the subfield 'PBN', F10a must contain an 'R';}}
\DoxyCodeLine{131 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',}}
\DoxyCodeLine{132 \textcolor{stringliteral}{              'D2', 'O1' or 'O2', then F10a must contain the letter 'G';}}
\DoxyCodeLine{133 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',}}
\DoxyCodeLine{134 \textcolor{stringliteral}{              'D3', 'O1' or 'O3', then F10a must contain the letter 'D';}}
\DoxyCodeLine{135 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must}}
\DoxyCodeLine{136 \textcolor{stringliteral}{              contain either an O' or 'S' and a 'D';}}
\DoxyCodeLine{137 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',}}
\DoxyCodeLine{138 \textcolor{stringliteral}{              'D4', 'O1' or 'O4', then F10a must contain the letter 'I';}}
\DoxyCodeLine{139 \textcolor{stringliteral}{            -\/ If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'}}
\DoxyCodeLine{140 \textcolor{stringliteral}{              or 'O4', then F10a must contain the letter 'D';}}
\DoxyCodeLine{141 \textcolor{stringliteral}{        Another way to simplify the logic is to use a table to identify the permutations:}}
\DoxyCodeLine{142 \textcolor{stringliteral}{             | B1| B2| B3| B4| B5| C1| C2| C3| C4| D1| D2| D3| D4| O1| O2| O3| O4|}}
\DoxyCodeLine{143 \textcolor{stringliteral}{          D  | X |   | X | X |   | X |   | X | X | X |   | X | X | X |   | X | X |}}
\DoxyCodeLine{144 \textcolor{stringliteral}{          G  | X | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   |}}
\DoxyCodeLine{145 \textcolor{stringliteral}{          I  | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   | X |}}
\DoxyCodeLine{146 \textcolor{stringliteral}{         O|S | X |   |   | X |   |   |   |   |   |   |   |   |   |   |   |   |   |}}
\DoxyCodeLine{147 \textcolor{stringliteral}{          R  | X | X | X | X | X |   |   |   |   |   |   |   |   |   |   |   |   |}}
\DoxyCodeLine{148 \textcolor{stringliteral}{}}
\DoxyCodeLine{149 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record used for checking consistency;}}
\DoxyCodeLine{150 \textcolor{stringliteral}{        :param f10a: The contents of field 10a;}}
\DoxyCodeLine{151 \textcolor{stringliteral}{        :return: False if errors are detected, True if all is OK;}}
\DoxyCodeLine{152 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{153         result = \textcolor{keyword}{True}}
\DoxyCodeLine{154         pbn = flight\_plan\_record.get\_icao\_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18pbn)}
\DoxyCodeLine{155         \textcolor{keywordflow}{if} pbn \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{156             \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B1|B3|B4|C1|C3|C4|D1|D3|D4|O1|O3|O4"}, pbn.get\_field\_text())) != 0:}
\DoxyCodeLine{157                 \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"D"}) == -\/1:}
\DoxyCodeLine{158                     \textcolor{comment}{\# Missing 'D' in field 10a, error}}
\DoxyCodeLine{159                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_PBN\_D)}
\DoxyCodeLine{160                     result = \textcolor{keyword}{False}}
\DoxyCodeLine{161             \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B1|B2|C1|C2|D1|D2|O1|O2"}, pbn.get\_field\_text())) != 0:}
\DoxyCodeLine{162                 \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"G"}) == -\/1:}
\DoxyCodeLine{163                     \textcolor{comment}{\# Missing 'G' in field 10a, error}}
\DoxyCodeLine{164                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_PBN\_G)}
\DoxyCodeLine{165                     result = \textcolor{keyword}{False}}
\DoxyCodeLine{166             \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B1|B5|C1|C4|D1|D4|O1|O4"}, pbn.get\_field\_text())) != 0:}
\DoxyCodeLine{167                 \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"I"}) == -\/1:}
\DoxyCodeLine{168                     \textcolor{comment}{\# Missing 'I' in field 10a, error}}
\DoxyCodeLine{169                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_PBN\_I)}
\DoxyCodeLine{170                     result = \textcolor{keyword}{False}}
\DoxyCodeLine{171             \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B1|B4"}, pbn.get\_field\_text())) != 0:}
\DoxyCodeLine{172                 \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"[OS]"}, f10a)) == 0:}
\DoxyCodeLine{173                     \textcolor{comment}{\# Missing 'O' and 'S' in field 10a, error}}
\DoxyCodeLine{174                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_PBN\_OS)}
\DoxyCodeLine{175                     result = \textcolor{keyword}{False}}
\DoxyCodeLine{176             \textcolor{keywordflow}{if} len(re.findall(\textcolor{stringliteral}{"B[1-\/5]"}, pbn.get\_field\_text())) != 0:}
\DoxyCodeLine{177                 \textcolor{keywordflow}{if} f10a.find(\textcolor{stringliteral}{"R"}) == -\/1:}
\DoxyCodeLine{178                     \textcolor{comment}{\# Missing 'R' in field 10a, error}}
\DoxyCodeLine{179                     Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"'PBN'"}, 0, 0, self.EM, ErrorId.CONSISTENCY\_PBN\_R)}
\DoxyCodeLine{180                     result = \textcolor{keyword}{False}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182         \textcolor{keywordflow}{return} result}
\DoxyCodeLine{183 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a4d4602457890a1637bd59d62c54861af}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a4d4602457890a1637bd59d62c54861af}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!correct\_ers\_indices@{correct\_ers\_indices}}
\index{correct\_ers\_indices@{correct\_ers\_indices}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{correct\_ers\_indices()}{correct\_ers\_indices()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+correct\+\_\+ers\+\_\+indices (\begin{DoxyParamCaption}\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}This method corrects the Field 15 extracted route records start and end indices to add the
start index of Field 15's position in the message as a whole. The ERS records (and any associated
ERS error records) start and end indices were calculated based on the start of field 15, (any
field parsing always starts at zero). To correctly index a field 15 token with respect to the
message as a whole, the field 15 start index must be added to all start and end indices in the
ERS records.

:param flight_plan_record: The flight plan having its ERS records modified;
:return: None
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{360     \textcolor{keyword}{def }correct\_ers\_indices(flight\_plan\_record):}
\DoxyCodeLine{361         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> None}}
\DoxyCodeLine{362         \textcolor{stringliteral}{"""This method corrects the Field 15 extracted route records start and end indices to add the}}
\DoxyCodeLine{363 \textcolor{stringliteral}{        start index of Field 15's position in the message as a whole. The ERS records (and any associated}}
\DoxyCodeLine{364 \textcolor{stringliteral}{        ERS error records) start and end indices were calculated based on the start of field 15, (any}}
\DoxyCodeLine{365 \textcolor{stringliteral}{        field parsing always starts at zero). To correctly index a field 15 token with respect to the}}
\DoxyCodeLine{366 \textcolor{stringliteral}{        message as a whole, the field 15 start index must be added to all start and end indices in the}}
\DoxyCodeLine{367 \textcolor{stringliteral}{        ERS records.}}
\DoxyCodeLine{368 \textcolor{stringliteral}{}}
\DoxyCodeLine{369 \textcolor{stringliteral}{        :param flight\_plan\_record: The flight plan having its ERS records modified;}}
\DoxyCodeLine{370 \textcolor{stringliteral}{        :return: None}}
\DoxyCodeLine{371 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{372 }
\DoxyCodeLine{373         \textcolor{comment}{\# Make sure we have the resources needed to resolve the field 15 ERS indices}}
\DoxyCodeLine{374         \textcolor{keywordflow}{if} flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F15) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{375             \textcolor{keywordflow}{return}}
\DoxyCodeLine{376         \textcolor{keywordflow}{if} flight\_plan\_record.get\_extracted\_route() \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{377             \textcolor{keywordflow}{return}}
\DoxyCodeLine{378 }
\DoxyCodeLine{379         f15\_field\_start\_index = flight\_plan\_record.get\_icao\_field(FieldIdentifiers.F15).get\_start\_index()}
\DoxyCodeLine{380 }
\DoxyCodeLine{381         \textcolor{keywordflow}{for} ers\_record \textcolor{keywordflow}{in} flight\_plan\_record.get\_extracted\_route().get\_all\_elements():}
\DoxyCodeLine{382             ers\_record.set\_start\_index(ers\_record.get\_start\_index() + f15\_field\_start\_index)}
\DoxyCodeLine{383             ers\_record.set\_end\_index(ers\_record.get\_end\_index() + f15\_field\_start\_index)}
\DoxyCodeLine{384 }
\DoxyCodeLine{385         \textcolor{keywordflow}{for} ers\_error \textcolor{keywordflow}{in} flight\_plan\_record.get\_extracted\_route().get\_all\_errors():}
\DoxyCodeLine{386             ers\_error.set\_start\_index(ers\_error.get\_start\_index() + f15\_field\_start\_index)}
\DoxyCodeLine{387             ers\_error.set\_end\_index(ers\_error.get\_end\_index() + f15\_field\_start\_index)}
\DoxyCodeLine{388 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a5965b24538807e17988e75ffbf3d2e93}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a5965b24538807e17988e75ffbf3d2e93}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!determine\_message\_type@{determine\_message\_type}}
\index{determine\_message\_type@{determine\_message\_type}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{determine\_message\_type()}{determine\_message\_type()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+determine\+\_\+message\+\_\+type (\begin{DoxyParamCaption}\item[{}]{f3 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}This method determines the message type (ICAO ATS, OLDI or ADEXP) based on a message title.

:param f3: The message title as a string
:return: An enumeration from MessageDescriptions.MessageTypes; if the title is undefined / not
 supported then MessageDescriptions.MessageTypes.UNKNOWN is returned.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{390     \textcolor{keyword}{def }determine\_message\_type(f3):}
\DoxyCodeLine{391         \textcolor{comment}{\# type: (str) -\/> MessageTypes}}
\DoxyCodeLine{392         \textcolor{stringliteral}{"""This method determines the message type (ICAO ATS, OLDI or ADEXP) based on a message title.}}
\DoxyCodeLine{393 \textcolor{stringliteral}{}}
\DoxyCodeLine{394 \textcolor{stringliteral}{        :param f3: The message title as a string}}
\DoxyCodeLine{395 \textcolor{stringliteral}{        :return: An enumeration from MessageDescriptions.MessageTypes; if the title is undefined / not}}
\DoxyCodeLine{396 \textcolor{stringliteral}{                 supported then MessageDescriptions.MessageTypes.UNKNOWN is returned.}}
\DoxyCodeLine{397 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{398         \textcolor{keywordflow}{if} len(f3) < 3:}
\DoxyCodeLine{399             \textcolor{comment}{\# Cannot be a message title, too short, error}}
\DoxyCodeLine{400             \textcolor{keywordflow}{return} MessageTypes.UNKNOWN}
\DoxyCodeLine{401 }
\DoxyCodeLine{402         message\_title = Utils.title\_defined(f3[0:3])}
\DoxyCodeLine{403         \textcolor{keywordflow}{if} message\_title \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{404             \textcolor{comment}{\# Title is not supported, error}}
\DoxyCodeLine{405             \textcolor{keywordflow}{return} MessageTypes.UNKNOWN}
\DoxyCodeLine{406 }
\DoxyCodeLine{407         \textcolor{keywordflow}{if} message\_title.value > MessageTitles.SPL.value:}
\DoxyCodeLine{408             \textcolor{keywordflow}{return} MessageTypes.OLDI}
\DoxyCodeLine{409 }
\DoxyCodeLine{410         \textcolor{keywordflow}{return} MessageTypes.ATS}
\DoxyCodeLine{411 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8ffdc5ea4ecfbb79a082f35c4c1e70e6}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8ffdc5ea4ecfbb79a082f35c4c1e70e6}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!get\_message\_description@{get\_message\_description}}
\index{get\_message\_description@{get\_message\_description}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{get\_message\_description()}{get\_message\_description()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+get\+\_\+message\+\_\+description (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{message\+\_\+title }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method gets the field list for a message based on its title, adjacent unit name and message
type. The field list contains a list of ICAO fields that must be included in a message and is used
by the field parsers to parse individual subfields. The field list is contained in an instance of the
MessageDescription class.

:param flight_plan_record: The Flight Plan Record containing the message to parse and into which all
       the parsed data is written; the name of an adjacent unit or DEFAULT if no name is defined
       for the message title being processed.
:param message_title: The message title of the message being processed;
:return: An instance of the MessageDescription class containing a list of all fields expected in a
 given message or None if a suitable field list could not be found. The latter case should
 never happen and most likely indicates an error in the configuration data.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{412     \textcolor{keyword}{def }get\_message\_description(self, flight\_plan\_record, message\_title):}
\DoxyCodeLine{413         \textcolor{comment}{\# type: (FlightPlanRecord, MessageTitles) -\/> MessageDescription | None}}
\DoxyCodeLine{414         \textcolor{stringliteral}{"""This method gets the field list for a message based on its title, adjacent unit name and message}}
\DoxyCodeLine{415 \textcolor{stringliteral}{        type. The field list contains a list of ICAO fields that must be included in a message and is used}}
\DoxyCodeLine{416 \textcolor{stringliteral}{        by the field parsers to parse individual subfields. The field list is contained in an instance of the}}
\DoxyCodeLine{417 \textcolor{stringliteral}{        MessageDescription class.}}
\DoxyCodeLine{418 \textcolor{stringliteral}{}}
\DoxyCodeLine{419 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse and into which all}}
\DoxyCodeLine{420 \textcolor{stringliteral}{               the parsed data is written; the name of an adjacent unit or DEFAULT if no name is defined}}
\DoxyCodeLine{421 \textcolor{stringliteral}{               for the message title being processed.}}
\DoxyCodeLine{422 \textcolor{stringliteral}{        :param message\_title: The message title of the message being processed;}}
\DoxyCodeLine{423 \textcolor{stringliteral}{        :return: An instance of the MessageDescription class containing a list of all fields expected in a}}
\DoxyCodeLine{424 \textcolor{stringliteral}{                 given message or None if a suitable field list could not be found. The latter case should}}
\DoxyCodeLine{425 \textcolor{stringliteral}{                 never happen and most likely indicates an error in the configuration data.}}
\DoxyCodeLine{426 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{427         md = self.FIM.get\_message\_content(flight\_plan\_record.get\_message\_type(),}
\DoxyCodeLine{428                                           flight\_plan\_record.get\_sender\_adjacent\_unit\_name(), message\_title)}
\DoxyCodeLine{429         \textcolor{keywordflow}{if} md \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{430             \textcolor{comment}{\# If we land here then data configuration is missing}}
\DoxyCodeLine{431             \textcolor{comment}{\# for the combination Message Type -\/> Adjacent Unit -\/> Message Title}}
\DoxyCodeLine{432             \textcolor{comment}{\# It is a data configuration error, we can add an error}}
\DoxyCodeLine{433             Utils.add\_error(}
\DoxyCodeLine{434                 flight\_plan\_record,}
\DoxyCodeLine{435                 \textcolor{stringliteral}{"Message Type: "} + flight\_plan\_record.get\_message\_type().name +}
\DoxyCodeLine{436                 \textcolor{stringliteral}{", Adjacent Unit Name: "} + flight\_plan\_record.get\_sender\_adjacent\_unit\_name().name +}
\DoxyCodeLine{437                 \textcolor{stringliteral}{", Message Title: "} + message\_title.name +}
\DoxyCodeLine{438                 \textcolor{stringliteral}{". Default configuration will be used."},}
\DoxyCodeLine{439                 0, 0, self.EM, ErrorId.SYSTEM\_CONFIG\_UNDEFINED)}
\DoxyCodeLine{440             \textcolor{comment}{\# Let's check if we can proceed with the default adjacent unit before we give up}}
\DoxyCodeLine{441             md = self.FIM.get\_message\_content(flight\_plan\_record.get\_message\_type(),}
\DoxyCodeLine{442                                               AdjacentUnits.DEFAULT, message\_title)}
\DoxyCodeLine{443             \textcolor{keywordflow}{if} md \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{444                 \textcolor{comment}{\# Shit out of luck, cannot proceed}}
\DoxyCodeLine{445                 Utils.add\_error(}
\DoxyCodeLine{446                     flight\_plan\_record,}
\DoxyCodeLine{447                     \textcolor{stringliteral}{"Message Type: "} + flight\_plan\_record.get\_message\_type().name +}
\DoxyCodeLine{448                     \textcolor{stringliteral}{", Adjacent Unit Name: "} + AdjacentUnits.DEFAULT.name +}
\DoxyCodeLine{449                     \textcolor{stringliteral}{", Message Title: "} + message\_title.name +}
\DoxyCodeLine{450                     \textcolor{stringliteral}{". No default configuration available, message cannot be processed."},}
\DoxyCodeLine{451                     0, 0, self.EM, ErrorId.SYSTEM\_CONFIG\_UNDEFINED)}
\DoxyCodeLine{452             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{453                 \textcolor{comment}{\# We have a default definition, proceed with this}}
\DoxyCodeLine{454                 flight\_plan\_record.set\_sender\_adjacent\_unit\_name(AdjacentUnits.DEFAULT)}
\DoxyCodeLine{455                 \textcolor{keywordflow}{return} md}
\DoxyCodeLine{456             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458         \textcolor{keywordflow}{return} md}
\DoxyCodeLine{459 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a326beef3299b89e57c48486a583f87fb}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a326beef3299b89e57c48486a583f87fb}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!is\_message\_valid@{is\_message\_valid}}
\index{is\_message\_valid@{is\_message\_valid}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{is\_message\_valid()}{is\_message\_valid()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+is\+\_\+message\+\_\+valid (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{message }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method carries out some rudimentary checks for:
    - A 'null' message
    - An empty message
    - A short message (less than MINIMUM_HEADER_LENGTH characters is treated as an erroneous case)
Any of the erroneous cases result in an error being written to the Flight Plan Record.

:param flight_plan_record: A flight plan record into which errors are written;
:param message: The message being parsed;
:return: False if errors are detected, True otherwise;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{460     \textcolor{keyword}{def }is\_message\_valid(self, flight\_plan\_record, message):}
\DoxyCodeLine{461         \textcolor{comment}{\# type: (FlightPlanRecord, str) -\/> bool}}
\DoxyCodeLine{462         \textcolor{stringliteral}{"""This method carries out some rudimentary checks for:}}
\DoxyCodeLine{463 \textcolor{stringliteral}{            -\/ A 'null' message}}
\DoxyCodeLine{464 \textcolor{stringliteral}{            -\/ An empty message}}
\DoxyCodeLine{465 \textcolor{stringliteral}{            -\/ A short message (less than MINIMUM\_HEADER\_LENGTH characters is treated as an erroneous case)}}
\DoxyCodeLine{466 \textcolor{stringliteral}{        Any of the erroneous cases result in an error being written to the Flight Plan Record.}}
\DoxyCodeLine{467 \textcolor{stringliteral}{}}
\DoxyCodeLine{468 \textcolor{stringliteral}{        :param flight\_plan\_record: A flight plan record into which errors are written;}}
\DoxyCodeLine{469 \textcolor{stringliteral}{        :param message: The message being parsed;}}
\DoxyCodeLine{470 \textcolor{stringliteral}{        :return: False if errors are detected, True otherwise;}}
\DoxyCodeLine{471 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{472         \textcolor{comment}{\# Do some very basic checks to make sure we have a valid message}}
\DoxyCodeLine{473         \textcolor{keywordflow}{if} message \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{474             \textcolor{comment}{\# Null message value}}
\DoxyCodeLine{475             flight\_plan\_record.add\_erroneous\_field(}
\DoxyCodeLine{476                 \textcolor{stringliteral}{"Null Field"}, self.EM.get\_error\_message(ErrorId.MSG\_EMPTY), 0, 0)}
\DoxyCodeLine{477             flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{478             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{479         \textcolor{keywordflow}{if} len(message) < 1:}
\DoxyCodeLine{480             \textcolor{comment}{\# Is an empty string}}
\DoxyCodeLine{481             Utils.add\_error(flight\_plan\_record, message, 0, 0, self.EM, ErrorId.MSG\_EMPTY)}
\DoxyCodeLine{482             flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{483             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{484         \textcolor{keywordflow}{if} len(message) < self.MINIMUM\_BODY\_LENGTH:}
\DoxyCodeLine{485             \textcolor{comment}{\# Is way too short}}
\DoxyCodeLine{486             Utils.add\_error(flight\_plan\_record, message, 0, len(message), self.EM, ErrorId.MSG\_TOO\_SHORT)}
\DoxyCodeLine{487             flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{488             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{489 }
\DoxyCodeLine{490         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{491 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a69c45ea4ce8af8d8423e742b2fb56a2e}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a69c45ea4ce8af8d8423e742b2fb56a2e}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_adexp@{parse\_adexp}}
\index{parse\_adexp@{parse\_adexp}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_adexp()}{parse\_adexp()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+adexp (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{493     \textcolor{keyword}{def }parse\_adexp(self, flight\_plan\_record):}
\DoxyCodeLine{494         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{495         \textcolor{comment}{\# Currently ADEXP messages are not supported, we report an error}}
\DoxyCodeLine{496         Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"ADEXP Not Supported"}, 0, 0, self.EM, ErrorId.MSG\_ADEXP\_NOT\_SUPPORTED)}
\DoxyCodeLine{497         \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{498 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a3cd41e750952a99f3e9fe4df0cd636c3}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a3cd41e750952a99f3e9fe4df0cd636c3}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_ats@{parse\_ats}}
\index{parse\_ats@{parse\_ats}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_ats()}{parse\_ats()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+ats (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}Parses an ICAO ATS message; when this method is called the following is known:
    - The message type is ICAO ATS (MessageTypes.ATS);
    - The message title is valid but the MessageTitle enumeration must be obtained;
    - As it's an ATS message, there is no adjacent unit identifier needed;
To obtain the appropriate field list for the message title the following are needed:
    - MessageTypes.ATS enumeration: Recover from the flight plan record;
    - MessageTitles.<Title enumeration>: This method will get this from the message title;
    - AdjacentUnit.DEFAULT: The default adjacent unit definition is used as there is no adjacent
      unit for ATS messages;

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if a supported message title could be identified, False if any errors were detected.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{499     \textcolor{keyword}{def }parse\_ats(self, flight\_plan\_record):}
\DoxyCodeLine{500         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{501         \textcolor{stringliteral}{"""Parses an ICAO ATS message; when this method is called the following is known:}}
\DoxyCodeLine{502 \textcolor{stringliteral}{            -\/ The message type is ICAO ATS (MessageTypes.ATS);}}
\DoxyCodeLine{503 \textcolor{stringliteral}{            -\/ The message title is valid but the MessageTitle enumeration must be obtained;}}
\DoxyCodeLine{504 \textcolor{stringliteral}{            -\/ As it's an ATS message, there is no adjacent unit identifier needed;}}
\DoxyCodeLine{505 \textcolor{stringliteral}{        To obtain the appropriate field list for the message title the following are needed:}}
\DoxyCodeLine{506 \textcolor{stringliteral}{            -\/ MessageTypes.ATS enumeration: Recover from the flight plan record;}}
\DoxyCodeLine{507 \textcolor{stringliteral}{            -\/ MessageTitles.<Title enumeration>: This method will get this from the message title;}}
\DoxyCodeLine{508 \textcolor{stringliteral}{            -\/ AdjacentUnit.DEFAULT: The default adjacent unit definition is used as there is no adjacent}}
\DoxyCodeLine{509 \textcolor{stringliteral}{              unit for ATS messages;}}
\DoxyCodeLine{510 \textcolor{stringliteral}{}}
\DoxyCodeLine{511 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse;}}
\DoxyCodeLine{512 \textcolor{stringliteral}{        :return: True if a supported message title could be identified, False if any errors were detected.}}
\DoxyCodeLine{513 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{514         \textcolor{comment}{\# Tokenize the message, open \& closed brackets will be removed}}
\DoxyCodeLine{515         tokens = self.tokenize\_message(flight\_plan\_record, \textcolor{stringliteral}{"()-\/\(\backslash\)r\(\backslash\)n\(\backslash\)t"})}
\DoxyCodeLine{516 }
\DoxyCodeLine{517         \textcolor{comment}{\# Get the message title enumeration}}
\DoxyCodeLine{518         message\_title = Utils.title\_defined(}
\DoxyCodeLine{519             tokens.get\_first\_token().get\_token\_string().replace(\textcolor{stringliteral}{" "}, \textcolor{stringliteral}{""})[0:3])}
\DoxyCodeLine{520 }
\DoxyCodeLine{521         \textcolor{keywordflow}{return} self.parse\_ats\_or\_oldi(flight\_plan\_record, tokens, message\_title)}
\DoxyCodeLine{522 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a1fe4ca0885654f150bf398edaa51117c}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a1fe4ca0885654f150bf398edaa51117c}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_ats\_header@{parse\_ats\_header}}
\index{parse\_ats\_header@{parse\_ats\_header}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_ats\_header()}{parse\_ats\_header()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+ats\+\_\+header (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method parses an ATS header and saves the fields to the FPR. The header parsing assumes
correct message semantics, that is the fields are expected in the following order:
    - <Priority Indicator>
    - <One or more Addressees>
    - <Filing Time> <Originator>
    - <One or more Additional Addressees>
The header is tokenized and the appropriate parser called on the fields in the expected order.
If fields are missing and/or extra, an error is reported as are any syntax errors.

:param flight_plan_record: Flight plan record containing the header field and where successfully
       parsed fields will be written to.
:return: True if parsing was successful, false if errors are detected.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{558     \textcolor{keyword}{def }parse\_ats\_header(self, flight\_plan\_record):}
\DoxyCodeLine{559         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{560         \textcolor{stringliteral}{"""This method parses an ATS header and saves the fields to the FPR. The header parsing assumes}}
\DoxyCodeLine{561 \textcolor{stringliteral}{        correct message semantics, that is the fields are expected in the following order:}}
\DoxyCodeLine{562 \textcolor{stringliteral}{            -\/ <Priority Indicator>}}
\DoxyCodeLine{563 \textcolor{stringliteral}{            -\/ <One or more Addressees>}}
\DoxyCodeLine{564 \textcolor{stringliteral}{            -\/ <Filing Time> <Originator>}}
\DoxyCodeLine{565 \textcolor{stringliteral}{            -\/ <One or more Additional Addressees>}}
\DoxyCodeLine{566 \textcolor{stringliteral}{        The header is tokenized and the appropriate parser called on the fields in the expected order.}}
\DoxyCodeLine{567 \textcolor{stringliteral}{        If fields are missing and/or extra, an error is reported as are any syntax errors.}}
\DoxyCodeLine{568 \textcolor{stringliteral}{}}
\DoxyCodeLine{569 \textcolor{stringliteral}{        :param flight\_plan\_record: Flight plan record containing the header field and where successfully}}
\DoxyCodeLine{570 \textcolor{stringliteral}{               parsed fields will be written to.}}
\DoxyCodeLine{571 \textcolor{stringliteral}{        :return: True if parsing was successful, false if errors are detected.}}
\DoxyCodeLine{572 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{573         \textcolor{comment}{\# Tokenize the header}}
\DoxyCodeLine{574         tokenize = Tokenize()}
\DoxyCodeLine{575         tokenize.set\_string\_to\_tokenize(flight\_plan\_record.get\_message\_header())}
\DoxyCodeLine{576         tokenize.set\_whitespace(\textcolor{stringliteral}{" \(\backslash\)n\(\backslash\)t\(\backslash\)r"})}
\DoxyCodeLine{577         tokenize.tokenize()}
\DoxyCodeLine{578         tokens: Tokens = tokenize.get\_tokens()}
\DoxyCodeLine{579 }
\DoxyCodeLine{580         \textcolor{comment}{\# Return if there is nothing in the header}}
\DoxyCodeLine{581         \textcolor{keywordflow}{if} tokens.get\_number\_of\_tokens() < 1:}
\DoxyCodeLine{582             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{583 }
\DoxyCodeLine{584         \textcolor{comment}{\# Some kind of header is present and ready for parsing, create empty fields in the FPR}}
\DoxyCodeLine{585         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.PRIORITY\_INDICATOR, \textcolor{stringliteral}{""}, 0, 0)}
\DoxyCodeLine{586         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.ADDRESS, \textcolor{stringliteral}{""}, 0, 0)}
\DoxyCodeLine{587         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.FILING\_TIME, \textcolor{stringliteral}{""}, 0, 0)}
\DoxyCodeLine{588         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.ORIGINATOR, \textcolor{stringliteral}{""}, 0, 0)}
\DoxyCodeLine{589         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.ADADDRESS, \textcolor{stringliteral}{""}, 0, 0)}
\DoxyCodeLine{590 }
\DoxyCodeLine{591         \textcolor{comment}{\# The following is used to indicate the 'state' of processing:}}
\DoxyCodeLine{592         \textcolor{comment}{\# 0 -\/> Next expected header field is the Priority Indicator}}
\DoxyCodeLine{593         \textcolor{comment}{\# 1 -\/> Next expected header field is an addressee field}}
\DoxyCodeLine{594         \textcolor{comment}{\# 2 -\/> Next expected header field is the Originator}}
\DoxyCodeLine{595         \textcolor{comment}{\# 3 -\/> Next expected header field is an additional addressee}}
\DoxyCodeLine{596         next\_field: int = 0}
\DoxyCodeLine{597         additional\_addressee\_available = \textcolor{keyword}{False}}
\DoxyCodeLine{598         \textcolor{comment}{\# Loop over the header fields}}
\DoxyCodeLine{599         \textcolor{keywordflow}{for} token \textcolor{keywordflow}{in} tokens.get\_tokens():}
\DoxyCodeLine{600             \textcolor{keywordflow}{if} next\_field == 0:  \textcolor{comment}{\# Process priority indicator}}
\DoxyCodeLine{601 }
\DoxyCodeLine{602                 \textcolor{comment}{\# Save the Priority Indicator}}
\DoxyCodeLine{603                 flight\_plan\_record.add\_icao\_field(FieldIdentifiers.PRIORITY\_INDICATOR,}
\DoxyCodeLine{604                                                   token.get\_token\_string(),}
\DoxyCodeLine{605                                                   token.get\_token\_start\_index(),}
\DoxyCodeLine{606                                                   token.get\_token\_end\_index())}
\DoxyCodeLine{607 }
\DoxyCodeLine{608                 \textcolor{comment}{\# Set up a new token for the addressee field(s)}}
\DoxyCodeLine{609                 flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{610                     FieldIdentifiers.ADDRESS,}
\DoxyCodeLine{611                     flight\_plan\_record.get\_icao\_field(FieldIdentifiers.ADDRESS).get\_field\_text(),}
\DoxyCodeLine{612                     token.get\_token\_end\_index() + 1,}
\DoxyCodeLine{613                     token.get\_token\_end\_index() + 1)}
\DoxyCodeLine{614 }
\DoxyCodeLine{615                 \textcolor{comment}{\# Indicates the next field is an addressee}}
\DoxyCodeLine{616                 next\_field = 1}
\DoxyCodeLine{617 }
\DoxyCodeLine{618             \textcolor{keywordflow}{elif} next\_field == 1:  \textcolor{comment}{\# Process addressee}}
\DoxyCodeLine{619                 \textcolor{keywordflow}{if} Utils.get\_first\_digit\_index(token.get\_token\_string()) == 0:}
\DoxyCodeLine{620                     \textcolor{comment}{\# Have to assume a field starting with a digit is the filing time}}
\DoxyCodeLine{621                     \textcolor{comment}{\# Save the Filing Time}}
\DoxyCodeLine{622                     flight\_plan\_record.add\_icao\_field(FieldIdentifiers.FILING\_TIME,}
\DoxyCodeLine{623                                                       token.get\_token\_string(),}
\DoxyCodeLine{624                                                       token.get\_token\_start\_index(),}
\DoxyCodeLine{625                                                       token.get\_token\_end\_index())}
\DoxyCodeLine{626 }
\DoxyCodeLine{627                     \textcolor{comment}{\# Indicate next field to process is the originator}}
\DoxyCodeLine{628                     next\_field = 2}
\DoxyCodeLine{629 }
\DoxyCodeLine{630                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{631                     \textcolor{comment}{\# Concatenate the addressees}}
\DoxyCodeLine{632                     flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{633                         FieldIdentifiers.ADDRESS,}
\DoxyCodeLine{634                         flight\_plan\_record.get\_icao\_field(}
\DoxyCodeLine{635                             FieldIdentifiers.ADDRESS).get\_field\_text() + token.get\_token\_string() + \textcolor{stringliteral}{" "},}
\DoxyCodeLine{636                         flight\_plan\_record.get\_icao\_field(FieldIdentifiers.ADDRESS).get\_start\_index(),}
\DoxyCodeLine{637                         token.get\_token\_end\_index())}
\DoxyCodeLine{638 }
\DoxyCodeLine{639             \textcolor{keywordflow}{elif} next\_field == 2:  \textcolor{comment}{\# Process the originator}}
\DoxyCodeLine{640 }
\DoxyCodeLine{641                 \textcolor{comment}{\# Save the Originator}}
\DoxyCodeLine{642                 flight\_plan\_record.add\_icao\_field(FieldIdentifiers.ORIGINATOR,}
\DoxyCodeLine{643                                                   token.get\_token\_string(),}
\DoxyCodeLine{644                                                   token.get\_token\_start\_index(),}
\DoxyCodeLine{645                                                   token.get\_token\_end\_index())}
\DoxyCodeLine{646 }
\DoxyCodeLine{647                 \textcolor{comment}{\# Set up a new token for the additional addressee field(s)}}
\DoxyCodeLine{648                 flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{649                     FieldIdentifiers.ADADDRESS,}
\DoxyCodeLine{650                     flight\_plan\_record.get\_icao\_field(FieldIdentifiers.ADADDRESS).get\_field\_text(),}
\DoxyCodeLine{651                     token.get\_token\_end\_index() + 1,}
\DoxyCodeLine{652                     token.get\_token\_end\_index() + 1)}
\DoxyCodeLine{653 }
\DoxyCodeLine{654                 next\_field = 3}
\DoxyCodeLine{655 }
\DoxyCodeLine{656             \textcolor{keywordflow}{elif} next\_field == 3:  \textcolor{comment}{\# Process additional addressees}}
\DoxyCodeLine{657 }
\DoxyCodeLine{658                 \textcolor{comment}{\# Concatenate the additional addressees}}
\DoxyCodeLine{659                 flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{660                     FieldIdentifiers.ADADDRESS,}
\DoxyCodeLine{661                     flight\_plan\_record.get\_icao\_field(}
\DoxyCodeLine{662                         FieldIdentifiers.ADADDRESS).get\_field\_text() + token.get\_token\_string() + \textcolor{stringliteral}{" "},}
\DoxyCodeLine{663                     flight\_plan\_record.get\_icao\_field(FieldIdentifiers.ADADDRESS).get\_start\_index(),}
\DoxyCodeLine{664                     token.get\_token\_end\_index())}
\DoxyCodeLine{665                 additional\_addressee\_available = \textcolor{keyword}{True}}
\DoxyCodeLine{666 }
\DoxyCodeLine{667         ParsePriorityIndicator(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{668         ParseAddressee(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{669         ParseFilingTime(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{670         ParseOriginator(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{671         \textcolor{keywordflow}{if} additional\_addressee\_available:}
\DoxyCodeLine{672             ParseAdditionalAddressee(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{673 }
\DoxyCodeLine{674         \textcolor{keywordflow}{return} flight\_plan\_record.errors\_detected()}
\DoxyCodeLine{675 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a38060cf90756eae4635b7ec2a1370979}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a38060cf90756eae4635b7ec2a1370979}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_ats\_or\_oldi@{parse\_ats\_or\_oldi}}
\index{parse\_ats\_or\_oldi@{parse\_ats\_or\_oldi}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_ats\_or\_oldi()}{parse\_ats\_or\_oldi()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+ats\+\_\+or\+\_\+oldi (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{tokens,  }\item[{}]{message\+\_\+title }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method parses the message fields. The field definition list is obtained based on the
message type, adjacent unit name and message title. The field definition list contains
information about all the subfields in each field and is used to parse individual subfields.

The individual parser methods are implemented as callbacks and stored with the field definition
list. Each parser callback adds the fields and subfields to the FPR. Once this method completes,
The FPR is fully populated with the message field and subfield content.

:param flight_plan_record: The Flight Plan Record containing the message to parse and into
       which all the parsed data is written;
:param tokens: The tokens containing individual ICAO fields;
:param message_title: The message title;
:return: True if the message was parsed without error, False if any errors were detected.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{676     \textcolor{keyword}{def }parse\_ats\_or\_oldi(self, flight\_plan\_record, tokens, message\_title):}
\DoxyCodeLine{677         \textcolor{comment}{\# type: (FlightPlanRecord, Tokens, MessageTitles) -\/> bool}}
\DoxyCodeLine{678         \textcolor{stringliteral}{"""This method parses the message fields. The field definition list is obtained based on the}}
\DoxyCodeLine{679 \textcolor{stringliteral}{        message type, adjacent unit name and message title. The field definition list contains}}
\DoxyCodeLine{680 \textcolor{stringliteral}{        information about all the subfields in each field and is used to parse individual subfields.}}
\DoxyCodeLine{681 \textcolor{stringliteral}{}}
\DoxyCodeLine{682 \textcolor{stringliteral}{        The individual parser methods are implemented as callbacks and stored with the field definition}}
\DoxyCodeLine{683 \textcolor{stringliteral}{        list. Each parser callback adds the fields and subfields to the FPR. Once this method completes,}}
\DoxyCodeLine{684 \textcolor{stringliteral}{        The FPR is fully populated with the message field and subfield content.}}
\DoxyCodeLine{685 \textcolor{stringliteral}{}}
\DoxyCodeLine{686 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse and into}}
\DoxyCodeLine{687 \textcolor{stringliteral}{               which all the parsed data is written;}}
\DoxyCodeLine{688 \textcolor{stringliteral}{        :param tokens: The tokens containing individual ICAO fields;}}
\DoxyCodeLine{689 \textcolor{stringliteral}{        :param message\_title: The message title;}}
\DoxyCodeLine{690 \textcolor{stringliteral}{        :return: True if the message was parsed without error, False if any errors were detected.}}
\DoxyCodeLine{691 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{692         \textcolor{comment}{\# Obtain the field list definition for this message title}}
\DoxyCodeLine{693         md: MessageDescription = self.get\_message\_description(flight\_plan\_record, message\_title)}
\DoxyCodeLine{694 }
\DoxyCodeLine{695         \textcolor{comment}{\# Check that a valid field list is defined}}
\DoxyCodeLine{696         \textcolor{keywordflow}{if} md \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{697             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{698 }
\DoxyCodeLine{699         \textcolor{comment}{\# Get the list of field parsers defined for this message}}
\DoxyCodeLine{700         field\_parsers: [ParseFieldsCommon] = md.get\_field\_parsers()}
\DoxyCodeLine{701 }
\DoxyCodeLine{702         \textcolor{comment}{\# Get the list of field identifiers defining fields included in this message}}
\DoxyCodeLine{703         field\_identifiers: [FieldIdentifiers] = md.get\_message\_fields()}
\DoxyCodeLine{704 }
\DoxyCodeLine{705         \textcolor{comment}{\# Loop over the fields in the list of tokens, (these are the fields to}}
\DoxyCodeLine{706         \textcolor{comment}{\# be parsed), by calling a parse method defined for each field.}}
\DoxyCodeLine{707         \textcolor{comment}{\# The list of fields to parse and the list of fields defined}}
\DoxyCodeLine{708         \textcolor{comment}{\# for this messages should be the same size, but if a field is missing or}}
\DoxyCodeLine{709         \textcolor{comment}{\# there are additional fields, then the lists will not match. The 'smallest'}}
\DoxyCodeLine{710         \textcolor{comment}{\# list is used to control the loop and avoid accessing invalid list entries;}}
\DoxyCodeLine{711         \textcolor{comment}{\# if the lists differ in size an error is reported.}}
\DoxyCodeLine{712         idx = 0}
\DoxyCodeLine{713         \textcolor{keywordflow}{if} tokens.get\_number\_of\_tokens() < md.get\_number\_of\_fields\_in\_message():}
\DoxyCodeLine{714             \textcolor{comment}{\# There are fewer fields to parse than fields defined for this message}}
\DoxyCodeLine{715             \textcolor{keywordflow}{for} token \textcolor{keywordflow}{in} tokens.get\_tokens():}
\DoxyCodeLine{716                 \textcolor{comment}{\# Save the field to be parsed to the flight plan}}
\DoxyCodeLine{717                 flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{718                     field\_identifiers[idx],}
\DoxyCodeLine{719                     token.get\_token\_string(),}
\DoxyCodeLine{720                     token.get\_token\_start\_index() + len(flight\_plan\_record.get\_message\_header()),}
\DoxyCodeLine{721                     token.get\_token\_end\_index() + len(flight\_plan\_record.get\_message\_header()))}
\DoxyCodeLine{722                 \textcolor{comment}{\# Get the appropriate field parser}}
\DoxyCodeLine{723                 fp = field\_parsers[idx](flight\_plan\_record, self.SFIF, self.SFD)}
\DoxyCodeLine{724                 \textcolor{comment}{\# Parse the field}}
\DoxyCodeLine{725                 fp.parse\_field()}
\DoxyCodeLine{726                 idx += 1}
\DoxyCodeLine{727 }
\DoxyCodeLine{728             \textcolor{comment}{\# Check if fewer fields to parse is allowed, some messages have optional fields}}
\DoxyCodeLine{729             difference = md.get\_number\_of\_fields\_in\_message() -\/ tokens.get\_number\_of\_tokens()}
\DoxyCodeLine{730             \textcolor{keywordflow}{if} message\_title == MessageTitles.FPL \textcolor{keywordflow}{and} difference == 1:}
\DoxyCodeLine{731                 \textcolor{comment}{\# This title has an optional field 19, we only report an error if more}}
\DoxyCodeLine{732                 \textcolor{comment}{\# than one field is missing}}
\DoxyCodeLine{733                 \textcolor{keywordflow}{return} flight\_plan\_record.errors\_detected()}
\DoxyCodeLine{734             Utils.add\_error(flight\_plan\_record, str(md.get\_number\_of\_fields\_in\_message()),}
\DoxyCodeLine{735                             tokens.get\_first\_token().get\_token\_start\_index(),}
\DoxyCodeLine{736                             tokens.get\_last\_token().get\_token\_end\_index(), self.EM,}
\DoxyCodeLine{737                             ErrorId.MSG\_TOO\_FEW\_FIELDS)}
\DoxyCodeLine{738         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{739             \textcolor{comment}{\# Either the fields to parse are equal to those defined, or we have more}}
\DoxyCodeLine{740             \textcolor{comment}{\# fields in the message than defined for the message.}}
\DoxyCodeLine{741             \textcolor{comment}{\# One special case exists for the CHG and ACH message, these messages}}
\DoxyCodeLine{742             \textcolor{comment}{\# have F22 as the last field that uses hyphens as field separators. For}}
\DoxyCodeLine{743             \textcolor{comment}{\# these messages, the F22 fields need to be concatenated into a single field.}}
\DoxyCodeLine{744             \textcolor{comment}{\# Check if the last field specified for this message is F22}}
\DoxyCodeLine{745             f22\_index = len(field\_identifiers) -\/ 1}
\DoxyCodeLine{746             \textcolor{keywordflow}{if} field\_identifiers[f22\_index] == FieldIdentifiers.F22 \textcolor{keywordflow}{or} \(\backslash\)}
\DoxyCodeLine{747                     field\_identifiers[f22\_index] == FieldIdentifiers.F22\_SPECIFIC:}
\DoxyCodeLine{748                 \textcolor{comment}{\# The last field in the list of field\_identifiers is F22, so this gives}}
\DoxyCodeLine{749                 \textcolor{comment}{\# us the index into the token list where F22 starts, all tokens including}}
\DoxyCodeLine{750                 \textcolor{comment}{\# this one up to the end of the token list are all F22 fields.}}
\DoxyCodeLine{751 }
\DoxyCodeLine{752                 \textcolor{comment}{\# Get the start index of field 22 in the original message}}
\DoxyCodeLine{753                 f22\_start\_index = tokens.get\_token\_at(f22\_index).get\_token\_start\_index()}
\DoxyCodeLine{754 }
\DoxyCodeLine{755                 \textcolor{comment}{\# Get the end index of field 22 in the original message}}
\DoxyCodeLine{756                 f22\_end\_index = tokens.get\_token\_at(len(tokens.get\_tokens()) -\/ 1).get\_token\_end\_index()}
\DoxyCodeLine{757 }
\DoxyCodeLine{758                 \textcolor{comment}{\# Retrieve the F22 string from the original message}}
\DoxyCodeLine{759                 f22\_concatenated = flight\_plan\_record.get\_message\_body()[f22\_start\_index -\/ 1:f22\_end\_index]}
\DoxyCodeLine{760 }
\DoxyCodeLine{761                 \textcolor{comment}{\# Save the field 22 string to the field 22 token along with its start and end index}}
\DoxyCodeLine{762                 tokens.get\_token\_at(f22\_index).set\_token\_string(f22\_concatenated)}
\DoxyCodeLine{763                 tokens.get\_token\_at(f22\_index).set\_token\_start\_index(f22\_start\_index)}
\DoxyCodeLine{764                 tokens.get\_token\_at(f22\_index).set\_token\_end\_index(f22\_end\_index)}
\DoxyCodeLine{765 }
\DoxyCodeLine{766                 \textcolor{comment}{\# Lop off the remainder of the list}}
\DoxyCodeLine{767                 tokens.remove\_tokens\_from\_end\_of\_list(f22\_index)}
\DoxyCodeLine{768 }
\DoxyCodeLine{769             \textcolor{keywordflow}{for} field\_parser \textcolor{keywordflow}{in} field\_parsers:}
\DoxyCodeLine{770                 \textcolor{comment}{\# Save the field to be parsed to the flight plan}}
\DoxyCodeLine{771                 flight\_plan\_record.add\_icao\_field(}
\DoxyCodeLine{772                     field\_identifiers[idx],}
\DoxyCodeLine{773                     tokens.get\_token\_at(idx).get\_token\_string(),}
\DoxyCodeLine{774                     tokens.get\_token\_at(idx).get\_token\_start\_index() + len(flight\_plan\_record.get\_message\_header()),}
\DoxyCodeLine{775                     tokens.get\_token\_at(idx).get\_token\_end\_index() + len(flight\_plan\_record.get\_message\_header()))}
\DoxyCodeLine{776                 \textcolor{comment}{\# Get the appropriate field parser}}
\DoxyCodeLine{777                 fp = field\_parser(flight\_plan\_record, self.SFIF, self.SFD)}
\DoxyCodeLine{778                 \textcolor{comment}{\# Parse the field}}
\DoxyCodeLine{779                 fp.parse\_field()}
\DoxyCodeLine{780                 idx += 1}
\DoxyCodeLine{781 }
\DoxyCodeLine{782             \textcolor{comment}{\# Check if we have more fields to parse than defined for this message}}
\DoxyCodeLine{783             \textcolor{keywordflow}{if} tokens.get\_number\_of\_tokens() > md.get\_number\_of\_fields\_in\_message():}
\DoxyCodeLine{784                 Utils.add\_error(flight\_plan\_record, tokens.get\_token\_at(idx).get\_token\_string(),}
\DoxyCodeLine{785                                 tokens.get\_token\_at(idx).get\_token\_start\_index(),}
\DoxyCodeLine{786                                 tokens.get\_token\_at(idx).get\_token\_end\_index(), self.EM,}
\DoxyCodeLine{787                                 ErrorId.MSG\_TOO\_MANY\_FIELDS)}
\DoxyCodeLine{788 }
\DoxyCodeLine{789         \textcolor{keywordflow}{return} flight\_plan\_record.errors\_detected()}
\DoxyCodeLine{790 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a97e87f0925994a34e7b4d3683dc56722}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a97e87f0925994a34e7b4d3683dc56722}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_message@{parse\_message}}
\index{parse\_message@{parse\_message}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_message()}{parse\_message()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+message (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{message }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method is the entry point for message parsing; the method takes an instance of FlightPlanRecord
(for output) and a string containing the message to parse. The FlightPlanRecord is populated by the
parser and includes all extracted fields, (if field 15 was present) is stored along with any route
extraction any errors. It is a callers responsibility to retrieve the errors.

:param flight_plan_record: A flight plan record into which all data extracted by the parser
       (including errors) are written;
:param message: The message with or without header;
:return: False if errors are detected, True otherwise;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{791     \textcolor{keyword}{def }parse\_message(self, flight\_plan\_record, message):}
\DoxyCodeLine{792         \textcolor{comment}{\# type: (FlightPlanRecord, str | None) -\/> bool}}
\DoxyCodeLine{793         \textcolor{stringliteral}{"""This method is the entry point for message parsing; the method takes an instance of FlightPlanRecord}}
\DoxyCodeLine{794 \textcolor{stringliteral}{        (for output) and a string containing the message to parse. The FlightPlanRecord is populated by the}}
\DoxyCodeLine{795 \textcolor{stringliteral}{        parser and includes all extracted fields, (if field 15 was present) is stored along with any route}}
\DoxyCodeLine{796 \textcolor{stringliteral}{        extraction any errors. It is a callers responsibility to retrieve the errors.}}
\DoxyCodeLine{797 \textcolor{stringliteral}{}}
\DoxyCodeLine{798 \textcolor{stringliteral}{        :param flight\_plan\_record: A flight plan record into which all data extracted by the parser}}
\DoxyCodeLine{799 \textcolor{stringliteral}{               (including errors) are written;}}
\DoxyCodeLine{800 \textcolor{stringliteral}{        :param message: The message with or without header;}}
\DoxyCodeLine{801 \textcolor{stringliteral}{        :return: False if errors are detected, True otherwise;}}
\DoxyCodeLine{802 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{803         \textcolor{comment}{\# Check if the message is worthy of further processing}}
\DoxyCodeLine{804         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.is\_message\_valid(flight\_plan\_record, message):}
\DoxyCodeLine{805             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{806 }
\DoxyCodeLine{807         \textcolor{comment}{\# Save the complete message to the FPR}}
\DoxyCodeLine{808         flight\_plan\_record.set\_message\_complete(message)}
\DoxyCodeLine{809 }
\DoxyCodeLine{810         \textcolor{comment}{\# Split and save the message header and body}}
\DoxyCodeLine{811         self.set\_message\_body\_and\_header(flight\_plan\_record)}
\DoxyCodeLine{812 }
\DoxyCodeLine{813         \textcolor{comment}{\# Go into more detail and establish the message type;}}
\DoxyCodeLine{814         \textcolor{comment}{\# (ICAO ATS, OLDI or ADEXP). The message type is stored in the FPR.}}
\DoxyCodeLine{815         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.set\_message\_type(flight\_plan\_record):}
\DoxyCodeLine{816             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{817 }
\DoxyCodeLine{818         \textcolor{comment}{\# Call the appropriate parser}}
\DoxyCodeLine{819         match flight\_plan\_record.get\_message\_type():}
\DoxyCodeLine{820             case MessageTypes.ADEXP:}
\DoxyCodeLine{821                 self.parse\_ats\_header(flight\_plan\_record)}
\DoxyCodeLine{822                 \textcolor{keywordflow}{return} self.parse\_adexp(flight\_plan\_record)}
\DoxyCodeLine{823             case MessageTypes.ATS:}
\DoxyCodeLine{824                 self.parse\_ats\_header(flight\_plan\_record)}
\DoxyCodeLine{825                 self.parse\_ats(flight\_plan\_record)}
\DoxyCodeLine{826             case MessageTypes.OLDI:}
\DoxyCodeLine{827                 self.parse\_oldi\_header(flight\_plan\_record)}
\DoxyCodeLine{828                 self.parse\_oldi(flight\_plan\_record)}
\DoxyCodeLine{829             case MessageTypes.UNKNOWN:}
\DoxyCodeLine{830                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{831 }
\DoxyCodeLine{832         \textcolor{comment}{\# Call the consistency checking routines}}
\DoxyCodeLine{833         self.consistency\_check(flight\_plan\_record)}
\DoxyCodeLine{834 }
\DoxyCodeLine{835         \textcolor{comment}{\# Correct the Extracted route start and end indices to reference them against the message as a whole}}
\DoxyCodeLine{836         self.correct\_ers\_indices(flight\_plan\_record)}
\DoxyCodeLine{837 }
\DoxyCodeLine{838         \textcolor{keywordflow}{return} \textcolor{keywordflow}{not} (flight\_plan\_record.errors\_detected() \textcolor{keywordflow}{or} len(flight\_plan\_record.get\_erroneous\_fields()))}
\DoxyCodeLine{839 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a13fbcfdb57c18c5e51ebaef3a475191f}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a13fbcfdb57c18c5e51ebaef3a475191f}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_oldi@{parse\_oldi}}
\index{parse\_oldi@{parse\_oldi}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_oldi()}{parse\_oldi()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+oldi (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This class parses an OLDI message. The difference between an ATS and OLDI message is that
the field list, i.e. the content of a given message based on its title, varies depending on the
adjacent unit that a message is being exchanged on.

This method calls the F3 parser which establishes the adjacent unit from F3b and sets this in
the FPR. The 'standard' ATS parser is then called which uses the adjacent unit to obtain the
correct field content definition.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if no errors were detected, False otherwise;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{523     \textcolor{keyword}{def }parse\_oldi(self, flight\_plan\_record):}
\DoxyCodeLine{524         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{525         \textcolor{stringliteral}{"""This class parses an OLDI message. The difference between an ATS and OLDI message is that}}
\DoxyCodeLine{526 \textcolor{stringliteral}{        the field list, i.e. the content of a given message based on its title, varies depending on the}}
\DoxyCodeLine{527 \textcolor{stringliteral}{        adjacent unit that a message is being exchanged on.}}
\DoxyCodeLine{528 \textcolor{stringliteral}{}}
\DoxyCodeLine{529 \textcolor{stringliteral}{        This method calls the F3 parser which establishes the adjacent unit from F3b and sets this in}}
\DoxyCodeLine{530 \textcolor{stringliteral}{        the FPR. The 'standard' ATS parser is then called which uses the adjacent unit to obtain the}}
\DoxyCodeLine{531 \textcolor{stringliteral}{        correct field content definition.}}
\DoxyCodeLine{532 \textcolor{stringliteral}{}}
\DoxyCodeLine{533 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse;}}
\DoxyCodeLine{534 \textcolor{stringliteral}{        :return: True if no errors were detected, False otherwise;}}
\DoxyCodeLine{535 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{536         \textcolor{comment}{\# Tokenize the message, open \& closed brackets will be removed}}
\DoxyCodeLine{537         tokens = self.tokenize\_message(flight\_plan\_record, \textcolor{stringliteral}{"()-\/\(\backslash\)r\(\backslash\)n\(\backslash\)t"})}
\DoxyCodeLine{538 }
\DoxyCodeLine{539         \textcolor{comment}{\# Get the message title enumeration}}
\DoxyCodeLine{540         message\_title = Utils.title\_defined(}
\DoxyCodeLine{541             tokens.get\_first\_token().get\_token\_string().replace(\textcolor{stringliteral}{" "}, \textcolor{stringliteral}{""})[0:3])}
\DoxyCodeLine{542 }
\DoxyCodeLine{543         \textcolor{comment}{\# For OLDI messages we need to establish the adjacent unit sender name}}
\DoxyCodeLine{544         \textcolor{comment}{\# To do this we must assume that the first token is F3a and at least F3b.}}
\DoxyCodeLine{545         \textcolor{comment}{\# F3b contains the sender unit name. If we parse F3 it will set the}}
\DoxyCodeLine{546         \textcolor{comment}{\# adjacent unit name into the FPR so that the appropriate field list can be}}
\DoxyCodeLine{547         \textcolor{comment}{\# obtained for the OLDI title/unit.}}
\DoxyCodeLine{548         \textcolor{comment}{\# Set F3 to the FPR}}
\DoxyCodeLine{549         flight\_plan\_record.add\_icao\_field(FieldIdentifiers.F3,}
\DoxyCodeLine{550                                           tokens.get\_first\_token().get\_token\_string(),}
\DoxyCodeLine{551                                           tokens.get\_first\_token().get\_token\_start\_index(),}
\DoxyCodeLine{552                                           tokens.get\_first\_token().get\_token\_end\_index())}
\DoxyCodeLine{553         \textcolor{comment}{\# Parse F3, this will assign the adjacent unit name to the FPR}}
\DoxyCodeLine{554         ParseF3(flight\_plan\_record, self.SFIF, self.SFD).parse\_field()}
\DoxyCodeLine{555 }
\DoxyCodeLine{556         \textcolor{keywordflow}{return} self.parse\_ats\_or\_oldi(flight\_plan\_record, tokens, message\_title)}
\DoxyCodeLine{557 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8649c4435e0efea774a2a2e8139b9cf2}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8649c4435e0efea774a2a2e8139b9cf2}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!parse\_oldi\_header@{parse\_oldi\_header}}
\index{parse\_oldi\_header@{parse\_oldi\_header}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{parse\_oldi\_header()}{parse\_oldi\_header()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+parse\+\_\+oldi\+\_\+header (\begin{DoxyParamCaption}\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{842     \textcolor{keyword}{def }parse\_oldi\_header(flight\_plan\_record):}
\DoxyCodeLine{843         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{844         \textcolor{keywordflow}{if} flight\_plan\_record.get\_message\_body() == \textcolor{stringliteral}{""}:}
\DoxyCodeLine{845             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{846         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{847 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a61af25fe26dae1209cdd46e8a31fc0ef}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a61af25fe26dae1209cdd46e8a31fc0ef}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!set\_message\_body\_and\_header@{set\_message\_body\_and\_header}}
\index{set\_message\_body\_and\_header@{set\_message\_body\_and\_header}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{set\_message\_body\_and\_header()}{set\_message\_body\_and\_header()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+set\+\_\+message\+\_\+body\+\_\+and\+\_\+header (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method determines if a message contains a header and message body or if it's a message
without a header. The message header and body are copied to the FPR if they are present.

Differentiating between the message header and body is achieved by detecting the presence or not
of the first hyphen or open bracket in a message. The action taken is as per the following truth table:
   Open     Hyphen '-'
 Hyphen | Bracket |  Before |
Present | Present | Bracket | Action
--------+---------+---------+--------------------------------------------
   No   |    No   |    x    | Save to message body + Process, no header
--------+---------+---------+--------------------------------------------
   No   |   Yes   |    x    | Split on Bracket, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |    No   |    x    | Split on Hyphen, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |   Yes   |   No    | Split on Bracket, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |   Yes   |  Yes    | Split on Hyphen, save to body and header + Process
--------+---------+---------+--------------------------------------------

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if the message header and body have been identified and stored, False if
 any errors were detected.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{848     \textcolor{keyword}{def }set\_message\_body\_and\_header(self, flight\_plan\_record):}
\DoxyCodeLine{849         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> None}}
\DoxyCodeLine{850         \textcolor{stringliteral}{"""This method determines if a message contains a header and message body or if it's a message}}
\DoxyCodeLine{851 \textcolor{stringliteral}{        without a header. The message header and body are copied to the FPR if they are present.}}
\DoxyCodeLine{852 \textcolor{stringliteral}{}}
\DoxyCodeLine{853 \textcolor{stringliteral}{        Differentiating between the message header and body is achieved by detecting the presence or not}}
\DoxyCodeLine{854 \textcolor{stringliteral}{        of the first hyphen or open bracket in a message. The action taken is as per the following truth table:}}
\DoxyCodeLine{855 \textcolor{stringliteral}{                   Open     Hyphen '-\/'}}
\DoxyCodeLine{856 \textcolor{stringliteral}{         Hyphen | Bracket |  Before |}}
\DoxyCodeLine{857 \textcolor{stringliteral}{        Present | Present | Bracket | Action}}
\DoxyCodeLine{858 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{859 \textcolor{stringliteral}{           No   |    No   |    x    | Save to message body + Process, no header}}
\DoxyCodeLine{860 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{861 \textcolor{stringliteral}{           No   |   Yes   |    x    | Split on Bracket, save to body and header + Process}}
\DoxyCodeLine{862 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{863 \textcolor{stringliteral}{          Yes   |    No   |    x    | Split on Hyphen, save to body and header + Process}}
\DoxyCodeLine{864 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{865 \textcolor{stringliteral}{          Yes   |   Yes   |   No    | Split on Bracket, save to body and header + Process}}
\DoxyCodeLine{866 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{867 \textcolor{stringliteral}{          Yes   |   Yes   |  Yes    | Split on Hyphen, save to body and header + Process}}
\DoxyCodeLine{868 \textcolor{stringliteral}{        -\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{869 \textcolor{stringliteral}{}}
\DoxyCodeLine{870 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse;}}
\DoxyCodeLine{871 \textcolor{stringliteral}{        :return: True if the message header and body have been identified and stored, False if}}
\DoxyCodeLine{872 \textcolor{stringliteral}{                 any errors were detected.}}
\DoxyCodeLine{873 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{874         msg = flight\_plan\_record.get\_message\_complete()}
\DoxyCodeLine{875 }
\DoxyCodeLine{876         \textcolor{comment}{\# Get the indices of the two characters that could indicate the start}}
\DoxyCodeLine{877         \textcolor{comment}{\# of the message body.}}
\DoxyCodeLine{878         hyphen\_index = msg.find(\textcolor{stringliteral}{"-\/"}, 0, len(msg))}
\DoxyCodeLine{879         open\_b\_index = msg.find(\textcolor{stringliteral}{"("}, 0, len(msg))}
\DoxyCodeLine{880 }
\DoxyCodeLine{881         \textcolor{comment}{\# Take action as described in the table for this methods' documentation.}}
\DoxyCodeLine{882         \textcolor{keywordflow}{if} hyphen\_index < 0 \textcolor{keywordflow}{and} open\_b\_index < 0:}
\DoxyCodeLine{883             \textcolor{comment}{\# Hyphen and Bracket Missing}}
\DoxyCodeLine{884             \textcolor{comment}{\# A LAM has no hyphen, and if a message was submitted without a bracket, then...}}
\DoxyCodeLine{885             \textcolor{comment}{\# Row 1 of the table in the comments}}
\DoxyCodeLine{886             flight\_plan\_record.set\_message\_header(\textcolor{stringliteral}{""})}
\DoxyCodeLine{887             flight\_plan\_record.set\_message\_body(msg)}
\DoxyCodeLine{888         \textcolor{keywordflow}{elif} (hyphen\_index < 0 \textcolor{keywordflow}{and} open\_b\_index > -\/1) \textcolor{keywordflow}{or} \(\backslash\)}
\DoxyCodeLine{889                 ((hyphen\_index > -\/1 \textcolor{keywordflow}{and} open\_b\_index > -\/1) \textcolor{keywordflow}{and} open\_b\_index < hyphen\_index):}
\DoxyCodeLine{890             \textcolor{comment}{\# (Hyphen missing, open bracket present) or}}
\DoxyCodeLine{891             \textcolor{comment}{\# ((Hyphen and bracket present) and Bracket before Hyphen)}}
\DoxyCodeLine{892             \textcolor{comment}{\# Rows 2 \& 4 of the table in the comments}}
\DoxyCodeLine{893             \textcolor{comment}{\# Split on bracket}}
\DoxyCodeLine{894             \textcolor{keywordflow}{if} open\_b\_index < self.MINIMUM\_HEADER\_LENGTH:}
\DoxyCodeLine{895                 flight\_plan\_record.set\_message\_header(\textcolor{stringliteral}{""})}
\DoxyCodeLine{896                 flight\_plan\_record.set\_message\_body(msg)}
\DoxyCodeLine{897             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{898                 flight\_plan\_record.set\_message\_header(msg[0:open\_b\_index])}
\DoxyCodeLine{899                 flight\_plan\_record.set\_message\_body(msg[open\_b\_index:])}
\DoxyCodeLine{900         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{901             \textcolor{comment}{\# (Hyphen present, open bracket missing) or}}
\DoxyCodeLine{902             \textcolor{comment}{\# ((Hyphen and bracket present) and Hyphen before Bracket)}}
\DoxyCodeLine{903             \textcolor{comment}{\# Rows 3 \& 5 of the table in the comments}}
\DoxyCodeLine{904             \textcolor{comment}{\# Split on hyphen}}
\DoxyCodeLine{905             \textcolor{keywordflow}{if} hyphen\_index < self.MINIMUM\_HEADER\_LENGTH:}
\DoxyCodeLine{906                 \textcolor{comment}{\# Safe to assume there is no header}}
\DoxyCodeLine{907                 flight\_plan\_record.set\_message\_header(\textcolor{stringliteral}{""})}
\DoxyCodeLine{908                 flight\_plan\_record.set\_message\_body(msg)}
\DoxyCodeLine{909             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{910                 flight\_plan\_record.set\_message\_header(msg[0:hyphen\_index])}
\DoxyCodeLine{911                 flight\_plan\_record.set\_message\_body(msg[hyphen\_index:])}
\DoxyCodeLine{912 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aff3ad13bc6a6afb7aeeb8e3761e8061e}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_aff3ad13bc6a6afb7aeeb8e3761e8061e}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!set\_message\_type@{set\_message\_type}}
\index{set\_message\_type@{set\_message\_type}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{set\_message\_type()}{set\_message\_type()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+set\+\_\+message\+\_\+type (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{flight\+\_\+plan\+\_\+record }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method sets the message type (ICAO ATS, OLDI or ADEXP) to the FPR. When this method
is called, the FPR contains a message body and maybe a header (if the message included a header).
This method recovers the message title from the start of the message body, and checks if it is a
supported message title. Using the title, the message type can be ascertained and set with one
of the enumeration values from the MessageDescriptions.MessageTypes class.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if a supported message title could be identified. False if any errors were detected.
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{913     \textcolor{keyword}{def }set\_message\_type(self, flight\_plan\_record):}
\DoxyCodeLine{914         \textcolor{comment}{\# type: (FlightPlanRecord) -\/> bool}}
\DoxyCodeLine{915         \textcolor{stringliteral}{"""This method sets the message type (ICAO ATS, OLDI or ADEXP) to the FPR. When this method}}
\DoxyCodeLine{916 \textcolor{stringliteral}{        is called, the FPR contains a message body and maybe a header (if the message included a header).}}
\DoxyCodeLine{917 \textcolor{stringliteral}{        This method recovers the message title from the start of the message body, and checks if it is a}}
\DoxyCodeLine{918 \textcolor{stringliteral}{        supported message title. Using the title, the message type can be ascertained and set with one}}
\DoxyCodeLine{919 \textcolor{stringliteral}{        of the enumeration values from the MessageDescriptions.MessageTypes class.}}
\DoxyCodeLine{920 \textcolor{stringliteral}{}}
\DoxyCodeLine{921 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse;}}
\DoxyCodeLine{922 \textcolor{stringliteral}{        :return: True if a supported message title could be identified. False if any errors were detected.}}
\DoxyCodeLine{923 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{924         msg\_body = flight\_plan\_record.get\_message\_body()}
\DoxyCodeLine{925         msg\_header = flight\_plan\_record.get\_message\_header()}
\DoxyCodeLine{926 }
\DoxyCodeLine{927         \textcolor{comment}{\# If we can find the '-\/TITLE' in some shape or form at the start}}
\DoxyCodeLine{928         \textcolor{comment}{\# of the field, we must have an ADEXP message.}}
\DoxyCodeLine{929         \textcolor{comment}{\# Regexp is for e.g '   -\/   TITLE' -\/> whitespace irrelevant}}
\DoxyCodeLine{930         \textcolor{keywordflow}{if} re.match(\textcolor{stringliteral}{"[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*-\/[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*TITLE"}, msg\_body) \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{931             \textcolor{comment}{\# We have an ADEXP message}}
\DoxyCodeLine{932             Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{""}, 0, 0, self.EM, ErrorId.MSG\_ADEXP\_NOT\_SUPPORTED)}
\DoxyCodeLine{933             flight\_plan\_record.set\_message\_type(MessageTypes.ADEXP)}
\DoxyCodeLine{934             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{935 }
\DoxyCodeLine{936         \textcolor{comment}{\# Try and locate an ATS message title, first attempt with a bracket}}
\DoxyCodeLine{937         \textcolor{comment}{\# Regexp is for e.g '   (   FPL' Bracket is optional, whitespace irrelevant}}
\DoxyCodeLine{938         f3 = re.match(\textcolor{stringliteral}{"[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*[(]?[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*[A-\/Z]\{3\}"}, msg\_body)}
\DoxyCodeLine{939         \textcolor{keywordflow}{if} f3 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{940             \textcolor{comment}{\# Message title not recognised, error, grab the first three characters}}
\DoxyCodeLine{941             m = re.match(\textcolor{stringliteral}{".\{3\}"}, msg\_body)}
\DoxyCodeLine{942             Utils.add\_error(flight\_plan\_record, m.group(0),}
\DoxyCodeLine{943                             len(msg\_header) + m.span()[1] -\/ 3,}
\DoxyCodeLine{944                             len(msg\_header) + m.span()[1], self.EM, ErrorId.F3\_TITLE\_SYNTAX)}
\DoxyCodeLine{945             flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{946             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{947 }
\DoxyCodeLine{948         \textcolor{comment}{\# Store the indices for future error reporting.}}
\DoxyCodeLine{949         end\_index = len(msg\_header) + f3.span()[1]}
\DoxyCodeLine{950         start\_index = end\_index -\/ 3}
\DoxyCodeLine{951 }
\DoxyCodeLine{952         \textcolor{comment}{\# We have a possible ATS message, extract the message title}}
\DoxyCodeLine{953         f3 = re.findall(\textcolor{stringliteral}{"[A-\/Z]\{3\}"}, f3.group(0))}
\DoxyCodeLine{954         \textcolor{keywordflow}{if} f3 \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{955             \textcolor{comment}{\# Try and figure out the message type}}
\DoxyCodeLine{956             message\_type = self.determine\_message\_type(f3[0])}
\DoxyCodeLine{957             \textcolor{keywordflow}{if} message\_type \textcolor{keywordflow}{is} MessageTypes.UNKNOWN:}
\DoxyCodeLine{958                 \textcolor{comment}{\# Unrecognised message title}}
\DoxyCodeLine{959                 Utils.add\_error(flight\_plan\_record, f3[0], start\_index, end\_index + 3,}
\DoxyCodeLine{960                                 self.EM, ErrorId.F3\_TITLE\_SYNTAX)}
\DoxyCodeLine{961                 flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{962                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{963             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{964                 \textcolor{comment}{\# Title recognized}}
\DoxyCodeLine{965                 \textcolor{comment}{\# One more check to do, some message titles are the same for}}
\DoxyCodeLine{966                 \textcolor{comment}{\# OLDI and ATS messages. OLDI messages always include F3b \& F3c.}}
\DoxyCodeLine{967                 \textcolor{comment}{\# Regexp is for e.g '   (   ACPAA/BB001' Bracket is optional, whitespace irrelevant}}
\DoxyCodeLine{968                 mm = re.match(\textcolor{stringliteral}{"[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*[(]?[ \(\backslash\)n\(\backslash\)r\(\backslash\)t]*[A-\/Z]\{3,7\}/[A-\/Z]\{1,4\}[0-\/9]\{1,3\}"}, msg\_body)}
\DoxyCodeLine{969                 message\_title = Utils.title\_defined(f3[0])}
\DoxyCodeLine{970                 \textcolor{keywordflow}{if} (message\_title \textcolor{keywordflow}{is} MessageTitles.ACP \textcolor{keywordflow}{or} message\_title \textcolor{keywordflow}{is} MessageTitles.CDN \textcolor{keywordflow}{or}}
\DoxyCodeLine{971                         message\_title \textcolor{keywordflow}{is} MessageTitles.CPL) \textcolor{keywordflow}{and} mm \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{972                     flight\_plan\_record.set\_message\_type(MessageTypes.OLDI)}
\DoxyCodeLine{973                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{974                     flight\_plan\_record.set\_message\_type(message\_type)}
\DoxyCodeLine{975                 \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{976         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{977             \textcolor{comment}{\# This should never ever happen}}
\DoxyCodeLine{978             Utils.add\_error(flight\_plan\_record, \textcolor{stringliteral}{"Regexp went wrong"}, 0, 0, self.EM, ErrorId.F3\_TITLE\_SYNTAX)}
\DoxyCodeLine{979             flight\_plan\_record.set\_message\_type(MessageTypes.UNKNOWN)}
\DoxyCodeLine{980             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{981 }

\end{DoxyCode}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0e3dc036d0345524348c5144b438055d}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0e3dc036d0345524348c5144b438055d}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!tokenize\_message@{tokenize\_message}}
\index{tokenize\_message@{tokenize\_message}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{tokenize\_message()}{tokenize\_message()}}
{\footnotesize\ttfamily def Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+tokenize\+\_\+message (\begin{DoxyParamCaption}\item[{}]{flight\+\_\+plan\+\_\+record,  }\item[{}]{whitespace }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}This method tokenizes a field or message based on the token separators in the parameter
'whitespace'.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:param whitespace: The whitespace characters used to delimit the tokens, these are all consumed by
       the parser apart from the forward slash character '/' which results in its own token.
:return: The list of tokens;
\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{983     \textcolor{keyword}{def }tokenize\_message(flight\_plan\_record, whitespace):}
\DoxyCodeLine{984         \textcolor{comment}{\# type: (FlightPlanRecord, str) -\/> Tokens}}
\DoxyCodeLine{985         \textcolor{stringliteral}{"""This method tokenizes a field or message based on the token separators in the parameter}}
\DoxyCodeLine{986 \textcolor{stringliteral}{        'whitespace'.}}
\DoxyCodeLine{987 \textcolor{stringliteral}{}}
\DoxyCodeLine{988 \textcolor{stringliteral}{        :param flight\_plan\_record: The Flight Plan Record containing the message to parse;}}
\DoxyCodeLine{989 \textcolor{stringliteral}{        :param whitespace: The whitespace characters used to delimit the tokens, these are all consumed by}}
\DoxyCodeLine{990 \textcolor{stringliteral}{               the parser apart from the forward slash character '/' which results in its own token.}}
\DoxyCodeLine{991 \textcolor{stringliteral}{        :return: The list of tokens;}}
\DoxyCodeLine{992 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{993         tokenizer = Tokenize()}
\DoxyCodeLine{994         tokenizer.set\_string\_to\_tokenize(flight\_plan\_record.get\_message\_body())}
\DoxyCodeLine{995         tokenizer.set\_whitespace(whitespace)}
\DoxyCodeLine{996         tokenizer.tokenize()}
\DoxyCodeLine{997         \textcolor{keywordflow}{return} tokenizer.get\_tokens()}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ac9f430a4912db205f3371bd0561b4b39}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_ac9f430a4912db205f3371bd0561b4b39}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!ErrorMessages@{ErrorMessages}}
\index{ErrorMessages@{ErrorMessages}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{ErrorMessages}{ErrorMessages}}
{\footnotesize\ttfamily Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+Error\+Messages\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0979c9d10b2856a1a424965c14898e8e}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a0979c9d10b2856a1a424965c14898e8e}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!FieldsInMessage@{FieldsInMessage}}
\index{FieldsInMessage@{FieldsInMessage}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{FieldsInMessage}{FieldsInMessage}}
{\footnotesize\ttfamily Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+Fields\+In\+Message\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a92f2c99a719bd6a23f3ca2755f576641}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a92f2c99a719bd6a23f3ca2755f576641}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!int@{int}}
\index{int@{int}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{int}{int}}
{\footnotesize\ttfamily Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+int\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a64bd0c972c9e1e5a9ab6c765f770c05b}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a64bd0c972c9e1e5a9ab6c765f770c05b}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!SubFieldDescriptions@{SubFieldDescriptions}}
\index{SubFieldDescriptions@{SubFieldDescriptions}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{SubFieldDescriptions}{SubFieldDescriptions}}
{\footnotesize\ttfamily Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+Sub\+Field\+Descriptions\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8c65544aeab4f892da49ca1d4bd617fb}\label{classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage_a8c65544aeab4f892da49ca1d4bd617fb}} 
\index{IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}!SubFieldsInFields@{SubFieldsInFields}}
\index{SubFieldsInFields@{SubFieldsInFields}!IcaoMessageParser.ParseMessage.ParseMessage@{IcaoMessageParser.ParseMessage.ParseMessage}}
\doxysubsubsection{\texorpdfstring{SubFieldsInFields}{SubFieldsInFields}}
{\footnotesize\ttfamily Icao\+Message\+Parser.\+Parse\+Message.\+Parse\+Message.\+Sub\+Fields\+In\+Fields\hspace{0.3cm}{\ttfamily [static]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Icao\+Message\+Parser/\mbox{\hyperlink{ParseMessage_8py}{Parse\+Message.\+py}}\end{DoxyCompactItemize}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICAO ATS and OLDI Message Parser: IcaoMessageParser.ParseMessage.ParseMessage Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICAO ATS and OLDI Message Parser
   &#160;<span id="projectnumber">V1.0</span>
   </div>
   <div id="projectbrief">Parser for processing ICAO and OLDI messages in the ICAO message format</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IcaoMessageParser.ParseMessage.ParseMessage Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8e7acae0f2d8586a53ca28d0906cdfa2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a8e7acae0f2d8586a53ca28d0906cdfa2">consistency_check</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a8e7acae0f2d8586a53ca28d0906cdfa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af705ae842f865c83ab40ba6addc58d07"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#af705ae842f865c83ab40ba6addc58d07">consistency_check_pbn</a> (self, flight_plan_record, f10a)</td></tr>
<tr class="separator:af705ae842f865c83ab40ba6addc58d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34196ff16405fd6669509479994b974"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#ae34196ff16405fd6669509479994b974">consistency_check_f9b_dep</a> (self, flight_plan_record)</td></tr>
<tr class="separator:ae34196ff16405fd6669509479994b974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af754e93999ff99cf471d6aee3edf497e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#af754e93999ff99cf471d6aee3edf497e">consistency_check_f10a_r</a> (self, flight_plan_record, f10a)</td></tr>
<tr class="separator:af754e93999ff99cf471d6aee3edf497e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047e8a0178e389d469b5ec45b1f89247"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a047e8a0178e389d469b5ec45b1f89247">consistency_check_f10a_z</a> (self, flight_plan_record, f10a)</td></tr>
<tr class="separator:a047e8a0178e389d469b5ec45b1f89247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e21bdcd3a838fa623a417b99beebe4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a59e21bdcd3a838fa623a417b99beebe4">consistency_check_f13a_dep</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a59e21bdcd3a838fa623a417b99beebe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b254954df042e2d8436d5f4ce3d969"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a57b254954df042e2d8436d5f4ce3d969">consistency_check_f16a_dep</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a57b254954df042e2d8436d5f4ce3d969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed74bf7dacf414e42fcc3cf986144622"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#aed74bf7dacf414e42fcc3cf986144622">consistency_check_flight_rules</a> (self, flight_plan_record)</td></tr>
<tr class="separator:aed74bf7dacf414e42fcc3cf986144622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ffdc5ea4ecfbb79a082f35c4c1e70e6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a8ffdc5ea4ecfbb79a082f35c4c1e70e6">get_message_description</a> (self, flight_plan_record, message_title)</td></tr>
<tr class="separator:a8ffdc5ea4ecfbb79a082f35c4c1e70e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326beef3299b89e57c48486a583f87fb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a326beef3299b89e57c48486a583f87fb">is_message_valid</a> (self, flight_plan_record, message)</td></tr>
<tr class="separator:a326beef3299b89e57c48486a583f87fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c45ea4ce8af8d8423e742b2fb56a2e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a69c45ea4ce8af8d8423e742b2fb56a2e">parse_adexp</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a69c45ea4ce8af8d8423e742b2fb56a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd41e750952a99f3e9fe4df0cd636c3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a3cd41e750952a99f3e9fe4df0cd636c3">parse_ats</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a3cd41e750952a99f3e9fe4df0cd636c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13fbcfdb57c18c5e51ebaef3a475191f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a13fbcfdb57c18c5e51ebaef3a475191f">parse_oldi</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a13fbcfdb57c18c5e51ebaef3a475191f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe4ca0885654f150bf398edaa51117c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a1fe4ca0885654f150bf398edaa51117c">parse_ats_header</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a1fe4ca0885654f150bf398edaa51117c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38060cf90756eae4635b7ec2a1370979"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a38060cf90756eae4635b7ec2a1370979">parse_ats_or_oldi</a> (self, flight_plan_record, tokens, message_title)</td></tr>
<tr class="separator:a38060cf90756eae4635b7ec2a1370979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e87f0925994a34e7b4d3683dc56722"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a97e87f0925994a34e7b4d3683dc56722">parse_message</a> (self, flight_plan_record, message)</td></tr>
<tr class="separator:a97e87f0925994a34e7b4d3683dc56722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61af25fe26dae1209cdd46e8a31fc0ef"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a61af25fe26dae1209cdd46e8a31fc0ef">set_message_body_and_header</a> (self, flight_plan_record)</td></tr>
<tr class="separator:a61af25fe26dae1209cdd46e8a31fc0ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff3ad13bc6a6afb7aeeb8e3761e8061e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#aff3ad13bc6a6afb7aeeb8e3761e8061e">set_message_type</a> (self, flight_plan_record)</td></tr>
<tr class="separator:aff3ad13bc6a6afb7aeeb8e3761e8061e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4d4602457890a1637bd59d62c54861af"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a4d4602457890a1637bd59d62c54861af">correct_ers_indices</a> (flight_plan_record)</td></tr>
<tr class="separator:a4d4602457890a1637bd59d62c54861af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5965b24538807e17988e75ffbf3d2e93"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a5965b24538807e17988e75ffbf3d2e93">determine_message_type</a> (f3)</td></tr>
<tr class="separator:a5965b24538807e17988e75ffbf3d2e93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8649c4435e0efea774a2a2e8139b9cf2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a8649c4435e0efea774a2a2e8139b9cf2">parse_oldi_header</a> (flight_plan_record)</td></tr>
<tr class="separator:a8649c4435e0efea774a2a2e8139b9cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e3dc036d0345524348c5144b438055d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a0e3dc036d0345524348c5144b438055d">tokenize_message</a> (flight_plan_record, whitespace)</td></tr>
<tr class="separator:a0e3dc036d0345524348c5144b438055d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a92f2c99a719bd6a23f3ca2755f576641"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a92f2c99a719bd6a23f3ca2755f576641">int</a></td></tr>
<tr class="separator:a92f2c99a719bd6a23f3ca2755f576641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0979c9d10b2856a1a424965c14898e8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a0979c9d10b2856a1a424965c14898e8e">FieldsInMessage</a></td></tr>
<tr class="separator:a0979c9d10b2856a1a424965c14898e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c65544aeab4f892da49ca1d4bd617fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a8c65544aeab4f892da49ca1d4bd617fb">SubFieldsInFields</a></td></tr>
<tr class="separator:a8c65544aeab4f892da49ca1d4bd617fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64bd0c972c9e1e5a9ab6c765f770c05b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#a64bd0c972c9e1e5a9ab6c765f770c05b">SubFieldDescriptions</a></td></tr>
<tr class="separator:a64bd0c972c9e1e5a9ab6c765f770c05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f430a4912db205f3371bd0561b4b39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html#ac9f430a4912db205f3371bd0561b4b39">ErrorMessages</a></td></tr>
<tr class="separator:ac9f430a4912db205f3371bd0561b4b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This class is the entry point for parsing complete ICAO format messages for both ATS and OLDI
messages. The parser is able to automatically evaluate if a message contains a header or not. For
ICAO ATS messages the data definitions are set up as a single data set; for OLDI messages the
definitions vary depending on an adjacent unit sending identifier.

The entry point method is 'parse_message()' that takes an instance of FlightPlanRecord and a
string containing the message to parse. The FlightPlanRecord is populated by the parser and
includes all extracted fields, an extracted route (if field 15 is present) and any errors. It
is a callers responsibility to retrieve the errors.

If this software is used in conjunction with a GUI, all the fields are stored with their zero
based index into the message so that erroneous fields can be highlighted in the GUI. This makes
message correction quite simple for end users.

Note: Eventually this parser will also support ADEXP message parsing; currently an error is reported
when an ADEXP message is encountered.

This class is thread safe and can be used simultaneously on multiple threads. This class includes
the message field list definitions (the configuration data for the parser) by instantiating the
MessageDescriptions class and assigning this the MCD member of this class.
</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a8e7acae0f2d8586a53ca28d0906cdfa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7acae0f2d8586a53ca28d0906cdfa2">&#9670;&nbsp;</a></span>consistency_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method performs consistency checking between various fields, that includes:
    - Flight rules between F8a and the flight rules derived by the F15 parsing and route
      extraction process; these must match.
    - If F10a contains the letter 'Z' then one or more of the F18 subfields
      'COM', 'NAV' or 'DAT' must be present;
    - If F10a contains the letter 'R' then the F18 'PBN' subfield must be present and
      contain one or more of the indicators 'B1', 'B2', 'B3', 'B4' or 'B5';
    - If F18 contains the subfield 'PBN', F10a must contain an 'R';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',
      'D2', 'O1' or 'O2', then F10a must contain the letter 'G';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',
      'D3', 'O1' or 'O3', then F10a must contain the letter 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must
      contain either an 'O' or 'S' and a 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',
      'D4', 'O1' or 'O4', then F10a must contain the letter 'I';
    - If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'
      or 'O4', then F10a must contain the letter 'D';

These consistency checks are only carried out on message titles defined to contain both field 10
and field 18, and/or field 8 and 15. These messages are:
    - AFP
    - ALR
    - APL
    - CPL
    - FPL

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">def </span>consistency_check(self, flight_plan_record):</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method performs consistency checking between various fields, that includes:</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">            - Flight rules between F8a and the flight rules derived by the F15 parsing and route</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">              extraction process; these must match.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">            - If F10a contains the letter &#39;Z&#39; then one or more of the F18 subfields</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">              &#39;COM&#39;, &#39;NAV&#39; or &#39;DAT&#39; must be present;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">            - If F10a contains the letter &#39;R&#39; then the F18 &#39;PBN&#39; subfield must be present and</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">              contain one or more of the indicators &#39;B1&#39;, &#39;B2&#39;, &#39;B3&#39;, &#39;B4&#39; or &#39;B5&#39;;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">            - If F18 contains the subfield &#39;PBN&#39;, F10a must contain an &#39;R&#39;;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B2&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral">              &#39;D2&#39;, &#39;O1&#39; or &#39;O2&#39;, then F10a must contain the letter &#39;G&#39;;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B3&#39;, &#39;C1&#39;, &#39;C3&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">              &#39;D3&#39;, &#39;O1&#39; or &#39;O3&#39;, then F10a must contain the letter &#39;D&#39;;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39; or &#39;B4&#39;, then F10a must</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">              contain either an &#39;O&#39; or &#39;S&#39; and a &#39;D&#39;;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B5&#39;, &#39;C1&#39;, &#39;C4&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral">              &#39;D4&#39;, &#39;O1&#39; or &#39;O4&#39;, then F10a must contain the letter &#39;I&#39;;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;C1&#39;, &#39;C4&#39;, &#39;D1&#39;, &#39;D4&#39;, &#39;O1&#39;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">              or &#39;O4&#39;, then F10a must contain the letter &#39;D&#39;;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">        These consistency checks are only carried out on message titles defined to contain both field 10</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">        and field 18, and/or field 8 and 15. These messages are:</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral">            - AFP</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">            - ALR</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">            - APL</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">            - CPL</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">            - FPL</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_message_title() <span class="keywordflow">is</span> <span class="keywordflow">not</span> MessageTitles.AFP <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                flight_plan_record.get_message_title() <span class="keywordflow">is</span> <span class="keywordflow">not</span> MessageTitles.ALR <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                flight_plan_record.get_message_title() <span class="keywordflow">is</span> <span class="keywordflow">not</span> MessageTitles.APL <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                flight_plan_record.get_message_title() <span class="keywordflow">is</span> <span class="keywordflow">not</span> MessageTitles.CPL <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                flight_plan_record.get_message_title() <span class="keywordflow">is</span> <span class="keywordflow">not</span> MessageTitles.FPL:</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment"># Consistency check the flight rules in F8a and those derived from F15</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        result1: bool = self.consistency_check_flight_rules(flight_plan_record)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment"># Check if the flight plan contains f10</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_field(FieldIdentifiers.F10) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">return</span> result1</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment"># Get field 10a</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F10, SubFieldIdentifiers.F10a) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            f10a = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            f10a = flight_plan_record.get_icao_subfield(FieldIdentifiers.F10, SubFieldIdentifiers.F10a).get_field_text()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment"># Check various field 10 consistency checks</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        result2 = self.consistency_check_f10a_r(flight_plan_record, f10a)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        result3 = self.consistency_check_f10a_z(flight_plan_record, f10a)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        result4 = self.consistency_check_pbn(flight_plan_record, f10a)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        result5 = self.consistency_check_f9b_dep(flight_plan_record)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        result6 = self.consistency_check_f13a_dep(flight_plan_record)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        result7 = self.consistency_check_f16a_dep(flight_plan_record)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">return</span> result1 <span class="keywordflow">or</span> result2 <span class="keywordflow">or</span> result3 <span class="keywordflow">or</span> result4 <span class="keywordflow">or</span> result5 <span class="keywordflow">or</span> result6 <span class="keywordflow">or</span> result7</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="af754e93999ff99cf471d6aee3edf497e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af754e93999ff99cf471d6aee3edf497e">&#9670;&nbsp;</a></span>consistency_check_f10a_r()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_f10a_r </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f10a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that if F10a contains the letter 'R' then the F18
'PBN' subfield must be present and contain one or more of the indicators
'B1', 'B2', 'B3', 'B4' or 'B5';;

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">def </span>consistency_check_f10a_r(self, flight_plan_record, f10a):</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str) -&gt; bool</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that if F10a contains the letter &#39;R&#39; then the F18</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral">        &#39;PBN&#39; subfield must be present and contain one or more of the indicators</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral">        &#39;B1&#39;, &#39;B2&#39;, &#39;B3&#39;, &#39;B4&#39; or &#39;B5&#39;;;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">        :param f10a: The contents of field 10a;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment"># Check if field 10a contains an &#39;Z&#39;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;Z&quot;</span>) &gt; -1:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18com) <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18nav) <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> \</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dat) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="comment"># Missing field 18 subfields, error</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;COM&#39;, &#39;NAV&#39; or &#39;DAT&#39;&quot;</span>, 0, 0,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                self.EM, ErrorId.CONSISTENCY_F10_Z)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a047e8a0178e389d469b5ec45b1f89247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047e8a0178e389d469b5ec45b1f89247">&#9670;&nbsp;</a></span>consistency_check_f10a_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_f10a_z </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f10a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that if F10a contains the letter 'Z' then one or
more of the F18 subfields 'COM', 'NAV' or 'DAT' must be present;

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">def </span>consistency_check_f10a_z(self, flight_plan_record, f10a):</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str) -&gt; bool</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that if F10a contains the letter &#39;Z&#39; then one or</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="stringliteral">        more of the F18 subfields &#39;COM&#39;, &#39;NAV&#39; or &#39;DAT&#39; must be present;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">        :param f10a: The contents of field 10a;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment"># Check if field 10a contains an &#39;R&#39;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;R&quot;</span>) &gt; -1:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            pbn = flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18pbn)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> pbn <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="comment"># Missing field 18 PBN subfield, error</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_F10_R)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B[1-5]&quot;</span>, pbn.get_field_text())) == 0:</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    <span class="comment"># Missing field 18 PBN B[1-5] indicators, error</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_F10_R)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a59e21bdcd3a838fa623a417b99beebe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e21bdcd3a838fa623a417b99beebe4">&#9670;&nbsp;</a></span>consistency_check_f13a_dep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_f13a_dep </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that if F13a contains 'ZZZZ' that there is
a field 18 DEP subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">def </span>consistency_check_f13a_dep(self, flight_plan_record):</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that if F13a contains &#39;ZZZZ&#39; that there is</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">        a field 18 DEP subfield;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment"># Check if the flight plan contains f13</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_field(FieldIdentifiers.F13) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment"># Get field 13a</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F13, SubFieldIdentifiers.F13a) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            f13a = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            f13a = flight_plan_record.get_icao_subfield(FieldIdentifiers.F13, SubFieldIdentifiers.F13a).get_field_text()</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment"># Check if field 13a contains an &#39;ZZZZ&#39;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> f13a == <span class="stringliteral">&quot;ZZZZ&quot;</span>:</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dep) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="comment"># Missing field 18 subfield DEP, error</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&quot;</span>, 0, 0,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                self.EM, ErrorId.CONSISTENCY_F13A_DEP)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57b254954df042e2d8436d5f4ce3d969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57b254954df042e2d8436d5f4ce3d969">&#9670;&nbsp;</a></span>consistency_check_f16a_dep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_f16a_dep </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that if F16a contains 'ZZZZ' that there is
a field 18 DEST subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">def </span>consistency_check_f16a_dep(self, flight_plan_record):</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that if F16a contains &#39;ZZZZ&#39; that there is</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">        a field 18 DEST subfield;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment"># Check if the flight plan contains f16</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_field(FieldIdentifiers.F16) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment"># Get field 16a</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F16, SubFieldIdentifiers.F16a) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            f16a = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            f16a = flight_plan_record.get_icao_subfield(FieldIdentifiers.F16, SubFieldIdentifiers.F16a).get_field_text()</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment"># Check if field 16a contains an &#39;ZZZZ&#39;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> f16a == <span class="stringliteral">&quot;ZZZZ&quot;</span>:</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18dest) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="comment"># Missing field 18 subfield DEST, error</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&quot;</span>, 0, 0,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                self.EM, ErrorId.CONSISTENCY_F16A_DEST)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae34196ff16405fd6669509479994b974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34196ff16405fd6669509479994b974">&#9670;&nbsp;</a></span>consistency_check_f9b_dep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_f9b_dep </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that if F9b contains 'ZZZZ' that there is
a field 18 TYP subfield;

:param flight_plan_record: Flight plan record used for checking consistency;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">def </span>consistency_check_f9b_dep(self, flight_plan_record):</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that if F9b contains &#39;ZZZZ&#39; that there is</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="stringliteral">        a field 18 TYP subfield;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment"># Check if the flight plan contains f9</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_field(FieldIdentifiers.F9) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment"># Get field 9b</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F9, SubFieldIdentifiers.F9b) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            f9b = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            f9b = flight_plan_record.get_icao_subfield(FieldIdentifiers.F9, SubFieldIdentifiers.F9b).get_field_text()</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment"># Check if field 9b contains &#39;ZZZZ&#39;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> f9b == <span class="stringliteral">&quot;ZZZZ&quot;</span>:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18typ) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="comment"># Missing field 18 subfield TYP, error</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_F9B_TYP)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="aed74bf7dacf414e42fcc3cf986144622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed74bf7dacf414e42fcc3cf986144622">&#9670;&nbsp;</a></span>consistency_check_flight_rules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_flight_rules </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks the flight rules given in Field 8a and
the rules derived from parsing and generated the extracted route from F15.

:param flight_plan_record: Flight plan record used for checking the flight rules consistency;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">def </span>consistency_check_flight_rules(self, flight_plan_record):</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks the flight rules given in Field 8a and</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="stringliteral">        the rules derived from parsing and generated the extracted route from F15.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking the flight rules consistency;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment"># If there is no extracted route bail out</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_extracted_route() <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment"># Get the derived flight rules from the extracted route and set the derived rules</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment"># to the flight plan record</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        flight_plan_record.set_derived_flight_rules(</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            FlightRules.get_flight_rules(</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                flight_plan_record.get_extracted_route().get_derived_flight_rules()))</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment"># Get the flight rules from field 8</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_subfield(FieldIdentifiers.F8, SubFieldIdentifiers.F8a) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            f8a = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            f8a = flight_plan_record.get_icao_subfield(FieldIdentifiers.F8, SubFieldIdentifiers.F8a).get_field_text()</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment"># Get the derived flight rules</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        derived_rules = flight_plan_record.get_derived_flight_rules()</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> f8a == <span class="stringliteral">&quot;&quot;</span>:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">if</span> derived_rules <span class="keywordflow">is</span> <span class="keywordflow">not</span> FlightRules.UNKNOWN:</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="comment"># Error, derived rules exist, nothing in Field 8a</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                Utils.add_error(flight_plan_record, derived_rules.name, 0, 0,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                self.EM, ErrorId.CONSISTENCY_F8_F8A_UNKNOWN)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">elif</span> derived_rules <span class="keywordflow">is</span> FlightRules.UNKNOWN:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> f8a != <span class="stringliteral">&quot;&quot;</span>:</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="comment"># Error, derived rules unknown but Field 8a has a rule assigned</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                Utils.add_error(flight_plan_record, f8a, 0, 0,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                self.EM, ErrorId.CONSISTENCY_F8_DERIVED_UNKNOWN)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">elif</span> FlightRules.get_flight_rules(f8a) <span class="keywordflow">is</span> <span class="keywordflow">not</span> derived_rules:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="comment"># Error, both flight rules available but different</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            Utils.add_error(flight_plan_record, derived_rules.name, 0, 0,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                            self.EM, ErrorId.CONSISTENCY_F8_F8_DERIVED_DIFFERENT)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="af705ae842f865c83ab40ba6addc58d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af705ae842f865c83ab40ba6addc58d07">&#9670;&nbsp;</a></span>consistency_check_pbn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.consistency_check_pbn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f10a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consistency checks that one of the following dealing with the field
18 PBN subfield:
    - If F18 contains the subfield 'PBN', F10a must contain an 'R';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B2', 'C1', 'C2', 'D1',
      'D2', 'O1' or 'O2', then F10a must contain the letter 'G';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B3', 'C1', 'C3', 'D1',
      'D3', 'O1' or 'O3', then F10a must contain the letter 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1' or 'B4', then F10a must
      contain either an O' or 'S' and a 'D';
    - If F18 'PBN' contains one or more of the indicators 'B1', 'B5', 'C1', 'C4', 'D1',
      'D4', 'O1' or 'O4', then F10a must contain the letter 'I';
    - If F18 'PBN' contains one or more of the indicators 'C1', 'C4', 'D1', 'D4', 'O1'
      or 'O4', then F10a must contain the letter 'D';
Another way to simplify the logic is to use a table to identify the permutations:
     | B1| B2| B3| B4| B5| C1| C2| C3| C4| D1| D2| D3| D4| O1| O2| O3| O4|
  D  | X |   | X | X |   | X |   | X | X | X |   | X | X | X |   | X | X |
  G  | X | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   |
  I  | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   | X |
 O|S | X |   |   | X |   |   |   |   |   |   |   |   |   |   |   |   |   |
  R  | X | X | X | X | X |   |   |   |   |   |   |   |   |   |   |   |   |

:param flight_plan_record: Flight plan record used for checking consistency;
:param f10a: The contents of field 10a;
:return: False if errors are detected, True if all is OK;
</pre> <div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">def </span>consistency_check_pbn(self, flight_plan_record, f10a):</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str) -&gt; bool</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method consistency checks that one of the following dealing with the field</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">        18 PBN subfield:</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral">            - If F18 contains the subfield &#39;PBN&#39;, F10a must contain an &#39;R&#39;;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B2&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">              &#39;D2&#39;, &#39;O1&#39; or &#39;O2&#39;, then F10a must contain the letter &#39;G&#39;;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B3&#39;, &#39;C1&#39;, &#39;C3&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">              &#39;D3&#39;, &#39;O1&#39; or &#39;O3&#39;, then F10a must contain the letter &#39;D&#39;;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39; or &#39;B4&#39;, then F10a must</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">              contain either an O&#39; or &#39;S&#39; and a &#39;D&#39;;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;B1&#39;, &#39;B5&#39;, &#39;C1&#39;, &#39;C4&#39;, &#39;D1&#39;,</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">              &#39;D4&#39;, &#39;O1&#39; or &#39;O4&#39;, then F10a must contain the letter &#39;I&#39;;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">            - If F18 &#39;PBN&#39; contains one or more of the indicators &#39;C1&#39;, &#39;C4&#39;, &#39;D1&#39;, &#39;D4&#39;, &#39;O1&#39;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">              or &#39;O4&#39;, then F10a must contain the letter &#39;D&#39;;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">        Another way to simplify the logic is to use a table to identify the permutations:</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">             | B1| B2| B3| B4| B5| C1| C2| C3| C4| D1| D2| D3| D4| O1| O2| O3| O4|</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">          D  | X |   | X | X |   | X |   | X | X | X |   | X | X | X |   | X | X |</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">          G  | X | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   |</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">          I  | X |   |   |   | X | X |   |   | X | X |   |   | X | X |   |   | X |</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">         O|S | X |   |   | X |   |   |   |   |   |   |   |   |   |   |   |   |   |</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">          R  | X | X | X | X | X |   |   |   |   |   |   |   |   |   |   |   |   |</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record used for checking consistency;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">        :param f10a: The contents of field 10a;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True if all is OK;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        result = <span class="keyword">True</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        pbn = flight_plan_record.get_icao_subfield(FieldIdentifiers.F18, SubFieldIdentifiers.F18pbn)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> pbn <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B1|B3|B4|C1|C3|C4|D1|D3|D4|O1|O3|O4&quot;</span>, pbn.get_field_text())) != 0:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;D&quot;</span>) == -1:</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="comment"># Missing &#39;D&#39; in field 10a, error</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_PBN_D)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    result = <span class="keyword">False</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B1|B2|C1|C2|D1|D2|O1|O2&quot;</span>, pbn.get_field_text())) != 0:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;G&quot;</span>) == -1:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <span class="comment"># Missing &#39;G&#39; in field 10a, error</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_PBN_G)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    result = <span class="keyword">False</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B1|B5|C1|C4|D1|D4|O1|O4&quot;</span>, pbn.get_field_text())) != 0:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;I&quot;</span>) == -1:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="comment"># Missing &#39;I&#39; in field 10a, error</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_PBN_I)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    result = <span class="keyword">False</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B1|B4&quot;</span>, pbn.get_field_text())) != 0:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;[OS]&quot;</span>, f10a)) == 0:</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="comment"># Missing &#39;O&#39; and &#39;S&#39; in field 10a, error</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_PBN_OS)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    result = <span class="keyword">False</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">if</span> len(re.findall(<span class="stringliteral">&quot;B[1-5]&quot;</span>, pbn.get_field_text())) != 0:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">if</span> f10a.find(<span class="stringliteral">&quot;R&quot;</span>) == -1:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="comment"># Missing &#39;R&#39; in field 10a, error</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&#39;PBN&#39;&quot;</span>, 0, 0, self.EM, ErrorId.CONSISTENCY_PBN_R)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    result = <span class="keyword">False</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span> result</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d4602457890a1637bd59d62c54861af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d4602457890a1637bd59d62c54861af">&#9670;&nbsp;</a></span>correct_ers_indices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.correct_ers_indices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">This method corrects the Field 15 extracted route records start and end indices to add the
start index of Field 15's position in the message as a whole. The ERS records (and any associated
ERS error records) start and end indices were calculated based on the start of field 15, (any
field parsing always starts at zero). To correctly index a field 15 token with respect to the
message as a whole, the field 15 start index must be added to all start and end indices in the
ERS records.

:param flight_plan_record: The flight plan having its ERS records modified;
:return: None
</pre> <div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">def </span>correct_ers_indices(flight_plan_record):</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; None</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method corrects the Field 15 extracted route records start and end indices to add the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">        start index of Field 15&#39;s position in the message as a whole. The ERS records (and any associated</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">        ERS error records) start and end indices were calculated based on the start of field 15, (any</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">        field parsing always starts at zero). To correctly index a field 15 token with respect to the</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral">        message as a whole, the field 15 start index must be added to all start and end indices in the</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">        ERS records.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">        :param flight_plan_record: The flight plan having its ERS records modified;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">        :return: None</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment"># Make sure we have the resources needed to resolve the field 15 ERS indices</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_icao_field(FieldIdentifiers.F15) <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_extracted_route() <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        f15_field_start_index = flight_plan_record.get_icao_field(FieldIdentifiers.F15).get_start_index()</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">for</span> ers_record <span class="keywordflow">in</span> flight_plan_record.get_extracted_route().get_all_elements():</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            ers_record.set_start_index(ers_record.get_start_index() + f15_field_start_index)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            ers_record.set_end_index(ers_record.get_end_index() + f15_field_start_index)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">for</span> ers_error <span class="keywordflow">in</span> flight_plan_record.get_extracted_route().get_all_errors():</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            ers_error.set_start_index(ers_error.get_start_index() + f15_field_start_index)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            ers_error.set_end_index(ers_error.get_end_index() + f15_field_start_index)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5965b24538807e17988e75ffbf3d2e93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5965b24538807e17988e75ffbf3d2e93">&#9670;&nbsp;</a></span>determine_message_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.determine_message_type </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f3</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">This method determines the message type (ICAO ATS, OLDI or ADEXP) based on a message title.

:param f3: The message title as a string
:return: An enumeration from MessageDescriptions.MessageTypes; if the title is undefined / not
 supported then MessageDescriptions.MessageTypes.UNKNOWN is returned.
</pre> <div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">def </span>determine_message_type(f3):</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment"># type: (str) -&gt; MessageTypes</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method determines the message type (ICAO ATS, OLDI or ADEXP) based on a message title.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">        :param f3: The message title as a string</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="stringliteral">        :return: An enumeration from MessageDescriptions.MessageTypes; if the title is undefined / not</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral">                 supported then MessageDescriptions.MessageTypes.UNKNOWN is returned.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span> len(f3) &lt; 3:</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment"># Cannot be a message title, too short, error</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">return</span> MessageTypes.UNKNOWN</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        message_title = Utils.title_defined(f3[0:3])</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">if</span> message_title <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="comment"># Title is not supported, error</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">return</span> MessageTypes.UNKNOWN</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">if</span> message_title.value &gt; MessageTitles.SPL.value:</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">return</span> MessageTypes.OLDI</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">return</span> MessageTypes.ATS</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ffdc5ea4ecfbb79a082f35c4c1e70e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ffdc5ea4ecfbb79a082f35c4c1e70e6">&#9670;&nbsp;</a></span>get_message_description()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.get_message_description </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message_title</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method gets the field list for a message based on its title, adjacent unit name and message
type. The field list contains a list of ICAO fields that must be included in a message and is used
by the field parsers to parse individual subfields. The field list is contained in an instance of the
MessageDescription class.

:param flight_plan_record: The Flight Plan Record containing the message to parse and into which all
       the parsed data is written; the name of an adjacent unit or DEFAULT if no name is defined
       for the message title being processed.
:param message_title: The message title of the message being processed;
:return: An instance of the MessageDescription class containing a list of all fields expected in a
 given message or None if a suitable field list could not be found. The latter case should
 never happen and most likely indicates an error in the configuration data.
</pre> <div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">def </span>get_message_description(self, flight_plan_record, message_title):</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment"># type: (FlightPlanRecord, MessageTitles) -&gt; MessageDescription | None</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method gets the field list for a message based on its title, adjacent unit name and message</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="stringliteral">        type. The field list contains a list of ICAO fields that must be included in a message and is used</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="stringliteral">        by the field parsers to parse individual subfields. The field list is contained in an instance of the</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="stringliteral">        MessageDescription class.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse and into which all</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="stringliteral">               the parsed data is written; the name of an adjacent unit or DEFAULT if no name is defined</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="stringliteral">               for the message title being processed.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="stringliteral">        :param message_title: The message title of the message being processed;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="stringliteral">        :return: An instance of the MessageDescription class containing a list of all fields expected in a</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="stringliteral">                 given message or None if a suitable field list could not be found. The latter case should</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="stringliteral">                 never happen and most likely indicates an error in the configuration data.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        md = self.FIM.get_message_content(flight_plan_record.get_message_type(),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                          flight_plan_record.get_sender_adjacent_unit_name(), message_title)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> md <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment"># If we land here then data configuration is missing</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="comment"># for the combination Message Type -&gt; Adjacent Unit -&gt; Message Title</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment"># It is a data configuration error, we can add an error</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            Utils.add_error(</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                flight_plan_record,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="stringliteral">&quot;Message Type: &quot;</span> + flight_plan_record.get_message_type().name +</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="stringliteral">&quot;, Adjacent Unit Name: &quot;</span> + flight_plan_record.get_sender_adjacent_unit_name().name +</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="stringliteral">&quot;, Message Title: &quot;</span> + message_title.name +</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="stringliteral">&quot;. Default configuration will be used.&quot;</span>,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                0, 0, self.EM, ErrorId.SYSTEM_CONFIG_UNDEFINED)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="comment"># Let&#39;s check if we can proceed with the default adjacent unit before we give up</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            md = self.FIM.get_message_content(flight_plan_record.get_message_type(),</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                              AdjacentUnits.DEFAULT, message_title)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">if</span> md <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="comment"># Shit out of luck, cannot proceed</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                Utils.add_error(</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    flight_plan_record,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    <span class="stringliteral">&quot;Message Type: &quot;</span> + flight_plan_record.get_message_type().name +</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="stringliteral">&quot;, Adjacent Unit Name: &quot;</span> + AdjacentUnits.DEFAULT.name +</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    <span class="stringliteral">&quot;, Message Title: &quot;</span> + message_title.name +</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="stringliteral">&quot;. No default configuration available, message cannot be processed.&quot;</span>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    0, 0, self.EM, ErrorId.SYSTEM_CONFIG_UNDEFINED)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="comment"># We have a default definition, proceed with this</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                flight_plan_record.set_sender_adjacent_unit_name(AdjacentUnits.DEFAULT)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">return</span> md</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span> md</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a326beef3299b89e57c48486a583f87fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326beef3299b89e57c48486a583f87fb">&#9670;&nbsp;</a></span>is_message_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.is_message_valid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method carries out some rudimentary checks for:
    - A 'null' message
    - An empty message
    - A short message (less than MINIMUM_HEADER_LENGTH characters is treated as an erroneous case)
Any of the erroneous cases result in an error being written to the Flight Plan Record.

:param flight_plan_record: A flight plan record into which errors are written;
:param message: The message being parsed;
:return: False if errors are detected, True otherwise;
</pre> <div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">def </span>is_message_valid(self, flight_plan_record, message):</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str) -&gt; bool</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method carries out some rudimentary checks for:</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="stringliteral">            - A &#39;null&#39; message</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="stringliteral">            - An empty message</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="stringliteral">            - A short message (less than MINIMUM_HEADER_LENGTH characters is treated as an erroneous case)</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="stringliteral">        Any of the erroneous cases result in an error being written to the Flight Plan Record.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="stringliteral">        :param flight_plan_record: A flight plan record into which errors are written;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">        :param message: The message being parsed;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True otherwise;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="comment"># Do some very basic checks to make sure we have a valid message</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">if</span> message <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="comment"># Null message value</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            flight_plan_record.add_erroneous_field(</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="stringliteral">&quot;Null Field&quot;</span>, self.EM.get_error_message(ErrorId.MSG_EMPTY), 0, 0)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> len(message) &lt; 1:</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment"># Is an empty string</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            Utils.add_error(flight_plan_record, message, 0, 0, self.EM, ErrorId.MSG_EMPTY)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> len(message) &lt; self.MINIMUM_BODY_LENGTH:</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="comment"># Is way too short</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            Utils.add_error(flight_plan_record, message, 0, len(message), self.EM, ErrorId.MSG_TOO_SHORT)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a69c45ea4ce8af8d8423e742b2fb56a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c45ea4ce8af8d8423e742b2fb56a2e">&#9670;&nbsp;</a></span>parse_adexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_adexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keyword">def </span>parse_adexp(self, flight_plan_record):</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment"># Currently ADEXP messages are not supported, we report an error</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;ADEXP Not Supported&quot;</span>, 0, 0, self.EM, ErrorId.MSG_ADEXP_NOT_SUPPORTED)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cd41e750952a99f3e9fe4df0cd636c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd41e750952a99f3e9fe4df0cd636c3">&#9670;&nbsp;</a></span>parse_ats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_ats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parses an ICAO ATS message; when this method is called the following is known:
    - The message type is ICAO ATS (MessageTypes.ATS);
    - The message title is valid but the MessageTitle enumeration must be obtained;
    - As it's an ATS message, there is no adjacent unit identifier needed;
To obtain the appropriate field list for the message title the following are needed:
    - MessageTypes.ATS enumeration: Recover from the flight plan record;
    - MessageTitles.&lt;Title enumeration&gt;: This method will get this from the message title;
    - AdjacentUnit.DEFAULT: The default adjacent unit definition is used as there is no adjacent
      unit for ATS messages;

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if a supported message title could be identified, False if any errors were detected.
</pre> <div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">def </span>parse_ats(self, flight_plan_record):</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Parses an ICAO ATS message; when this method is called the following is known:</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">            - The message type is ICAO ATS (MessageTypes.ATS);</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">            - The message title is valid but the MessageTitle enumeration must be obtained;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">            - As it&#39;s an ATS message, there is no adjacent unit identifier needed;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">        To obtain the appropriate field list for the message title the following are needed:</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">            - MessageTypes.ATS enumeration: Recover from the flight plan record;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral">            - MessageTitles.&lt;Title enumeration&gt;: This method will get this from the message title;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">            - AdjacentUnit.DEFAULT: The default adjacent unit definition is used as there is no adjacent</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">              unit for ATS messages;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral">        :return: True if a supported message title could be identified, False if any errors were detected.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment"># Tokenize the message, open &amp; closed brackets will be removed</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        tokens = self.tokenize_message(flight_plan_record, <span class="stringliteral">&quot;()-\r\n\t&quot;</span>)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment"># Get the message title enumeration</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        message_title = Utils.title_defined(</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            tokens.get_first_token().get_token_string().replace(<span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>)[0:3])</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> self.parse_ats_or_oldi(flight_plan_record, tokens, message_title)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fe4ca0885654f150bf398edaa51117c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fe4ca0885654f150bf398edaa51117c">&#9670;&nbsp;</a></span>parse_ats_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_ats_header </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method parses an ATS header and saves the fields to the FPR. The header parsing assumes
correct message semantics, that is the fields are expected in the following order:
    - &lt;Priority Indicator&gt;
    - &lt;One or more Addressees&gt;
    - &lt;Filing Time&gt; &lt;Originator&gt;
    - &lt;One or more Additional Addressees&gt;
The header is tokenized and the appropriate parser called on the fields in the expected order.
If fields are missing and/or extra, an error is reported as are any syntax errors.

:param flight_plan_record: Flight plan record containing the header field and where successfully
       parsed fields will be written to.
:return: True if parsing was successful, false if errors are detected.
</pre> <div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keyword">def </span>parse_ats_header(self, flight_plan_record):</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method parses an ATS header and saves the fields to the FPR. The header parsing assumes</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">        correct message semantics, that is the fields are expected in the following order:</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">            - &lt;Priority Indicator&gt;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">            - &lt;One or more Addressees&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">            - &lt;Filing Time&gt; &lt;Originator&gt;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">            - &lt;One or more Additional Addressees&gt;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">        The header is tokenized and the appropriate parser called on the fields in the expected order.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">        If fields are missing and/or extra, an error is reported as are any syntax errors.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">        :param flight_plan_record: Flight plan record containing the header field and where successfully</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">               parsed fields will be written to.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">        :return: True if parsing was successful, false if errors are detected.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment"># Tokenize the header</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        tokenize = Tokenize()</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        tokenize.set_string_to_tokenize(flight_plan_record.get_message_header())</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        tokenize.set_whitespace(<span class="stringliteral">&quot; \n\t\r&quot;</span>)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        tokenize.tokenize()</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        tokens: Tokens = tokenize.get_tokens()</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment"># Return if there is nothing in the header</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> tokens.get_number_of_tokens() &lt; 1:</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="comment"># Some kind of header is present and ready for parsing, create empty fields in the FPR</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.PRIORITY_INDICATOR, <span class="stringliteral">&quot;&quot;</span>, 0, 0)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.ADDRESS, <span class="stringliteral">&quot;&quot;</span>, 0, 0)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.FILING_TIME, <span class="stringliteral">&quot;&quot;</span>, 0, 0)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.ORIGINATOR, <span class="stringliteral">&quot;&quot;</span>, 0, 0)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.ADADDRESS, <span class="stringliteral">&quot;&quot;</span>, 0, 0)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="comment"># The following is used to indicate the &#39;state&#39; of processing:</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment"># 0 -&gt; Next expected header field is the Priority Indicator</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment"># 1 -&gt; Next expected header field is an addressee field</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment"># 2 -&gt; Next expected header field is the Originator</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment"># 3 -&gt; Next expected header field is an additional addressee</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        next_field: int = 0</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        additional_addressee_available = <span class="keyword">False</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment"># Loop over the header fields</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">for</span> token <span class="keywordflow">in</span> tokens.get_tokens():</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> next_field == 0:  <span class="comment"># Process priority indicator</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="comment"># Save the Priority Indicator</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                flight_plan_record.add_icao_field(FieldIdentifiers.PRIORITY_INDICATOR,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                                  token.get_token_string(),</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                  token.get_token_start_index(),</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                                  token.get_token_end_index())</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="comment"># Set up a new token for the addressee field(s)</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    FieldIdentifiers.ADDRESS,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    flight_plan_record.get_icao_field(FieldIdentifiers.ADDRESS).get_field_text(),</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    token.get_token_end_index() + 1,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    token.get_token_end_index() + 1)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="comment"># Indicates the next field is an addressee</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                next_field = 1</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">elif</span> next_field == 1:  <span class="comment"># Process addressee</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="keywordflow">if</span> Utils.get_first_digit_index(token.get_token_string()) == 0:</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    <span class="comment"># Have to assume a field starting with a digit is the filing time</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    <span class="comment"># Save the Filing Time</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    flight_plan_record.add_icao_field(FieldIdentifiers.FILING_TIME,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                                      token.get_token_string(),</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                                      token.get_token_start_index(),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                                      token.get_token_end_index())</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="comment"># Indicate next field to process is the originator</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    next_field = 2</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    <span class="comment"># Concatenate the addressees</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        FieldIdentifiers.ADDRESS,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        flight_plan_record.get_icao_field(</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                            FieldIdentifiers.ADDRESS).get_field_text() + token.get_token_string() + <span class="stringliteral">&quot; &quot;</span>,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        flight_plan_record.get_icao_field(FieldIdentifiers.ADDRESS).get_start_index(),</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        token.get_token_end_index())</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">elif</span> next_field == 2:  <span class="comment"># Process the originator</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="comment"># Save the Originator</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                flight_plan_record.add_icao_field(FieldIdentifiers.ORIGINATOR,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                                  token.get_token_string(),</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                                  token.get_token_start_index(),</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                  token.get_token_end_index())</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                <span class="comment"># Set up a new token for the additional addressee field(s)</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    FieldIdentifiers.ADADDRESS,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    flight_plan_record.get_icao_field(FieldIdentifiers.ADADDRESS).get_field_text(),</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    token.get_token_end_index() + 1,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    token.get_token_end_index() + 1)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                next_field = 3</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">elif</span> next_field == 3:  <span class="comment"># Process additional addressees</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <span class="comment"># Concatenate the additional addressees</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    FieldIdentifiers.ADADDRESS,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    flight_plan_record.get_icao_field(</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        FieldIdentifiers.ADADDRESS).get_field_text() + token.get_token_string() + <span class="stringliteral">&quot; &quot;</span>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    flight_plan_record.get_icao_field(FieldIdentifiers.ADADDRESS).get_start_index(),</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    token.get_token_end_index())</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                additional_addressee_available = <span class="keyword">True</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        ParsePriorityIndicator(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        ParseAddressee(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        ParseFilingTime(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        ParseOriginator(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> additional_addressee_available:</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            ParseAdditionalAddressee(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span> flight_plan_record.errors_detected()</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a38060cf90756eae4635b7ec2a1370979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38060cf90756eae4635b7ec2a1370979">&#9670;&nbsp;</a></span>parse_ats_or_oldi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_ats_or_oldi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message_title</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method parses the message fields. The field definition list is obtained based on the
message type, adjacent unit name and message title. The field definition list contains
information about all the subfields in each field and is used to parse individual subfields.

The individual parser methods are implemented as callbacks and stored with the field definition
list. Each parser callback adds the fields and subfields to the FPR. Once this method completes,
The FPR is fully populated with the message field and subfield content.

:param flight_plan_record: The Flight Plan Record containing the message to parse and into
       which all the parsed data is written;
:param tokens: The tokens containing individual ICAO fields;
:param message_title: The message title;
:return: True if the message was parsed without error, False if any errors were detected.
</pre> <div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keyword">def </span>parse_ats_or_oldi(self, flight_plan_record, tokens, message_title):</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment"># type: (FlightPlanRecord, Tokens, MessageTitles) -&gt; bool</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method parses the message fields. The field definition list is obtained based on the</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">        message type, adjacent unit name and message title. The field definition list contains</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral">        information about all the subfields in each field and is used to parse individual subfields.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">        The individual parser methods are implemented as callbacks and stored with the field definition</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">        list. Each parser callback adds the fields and subfields to the FPR. Once this method completes,</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">        The FPR is fully populated with the message field and subfield content.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse and into</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">               which all the parsed data is written;</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral">        :param tokens: The tokens containing individual ICAO fields;</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">        :param message_title: The message title;</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral">        :return: True if the message was parsed without error, False if any errors were detected.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment"># Obtain the field list definition for this message title</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        md: MessageDescription = self.get_message_description(flight_plan_record, message_title)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment"># Check that a valid field list is defined</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">if</span> md <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="comment"># Get the list of field parsers defined for this message</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        field_parsers: [ParseFieldsCommon] = md.get_field_parsers()</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment"># Get the list of field identifiers defining fields included in this message</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        field_identifiers: [FieldIdentifiers] = md.get_message_fields()</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment"># Loop over the fields in the list of tokens, (these are the fields to</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="comment"># be parsed), by calling a parse method defined for each field.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="comment"># The list of fields to parse and the list of fields defined</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="comment"># for this messages should be the same size, but if a field is missing or</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="comment"># there are additional fields, then the lists will not match. The &#39;smallest&#39;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment"># list is used to control the loop and avoid accessing invalid list entries;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment"># if the lists differ in size an error is reported.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        idx = 0</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">if</span> tokens.get_number_of_tokens() &lt; md.get_number_of_fields_in_message():</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="comment"># There are fewer fields to parse than fields defined for this message</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">for</span> token <span class="keywordflow">in</span> tokens.get_tokens():</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="comment"># Save the field to be parsed to the flight plan</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    field_identifiers[idx],</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    token.get_token_string(),</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    token.get_token_start_index() + len(flight_plan_record.get_message_header()),</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    token.get_token_end_index() + len(flight_plan_record.get_message_header()))</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment"># Get the appropriate field parser</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                fp = field_parsers[idx](flight_plan_record, self.SFIF, self.SFD)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="comment"># Parse the field</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                fp.parse_field()</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                idx += 1</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment"># Check if fewer fields to parse is allowed, some messages have optional fields</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            difference = md.get_number_of_fields_in_message() - tokens.get_number_of_tokens()</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span> message_title == MessageTitles.FPL <span class="keywordflow">and</span> difference == 1:</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="comment"># This title has an optional field 19, we only report an error if more</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="comment"># than one field is missing</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">return</span> flight_plan_record.errors_detected()</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            Utils.add_error(flight_plan_record, str(md.get_number_of_fields_in_message()),</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                            tokens.get_first_token().get_token_start_index(),</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                            tokens.get_last_token().get_token_end_index(), self.EM,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                            ErrorId.MSG_TOO_FEW_FIELDS)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment"># Either the fields to parse are equal to those defined, or we have more</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="comment"># fields in the message than defined for the message.</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment"># One special case exists for the CHG and ACH message, these messages</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="comment"># have F22 as the last field that uses hyphens as field separators. For</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="comment"># these messages, the F22 fields need to be concatenated into a single field.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment"># Check if the last field specified for this message is F22</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            f22_index = len(field_identifiers) - 1</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">if</span> field_identifiers[f22_index] == FieldIdentifiers.F22 <span class="keywordflow">or</span> \</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    field_identifiers[f22_index] == FieldIdentifiers.F22_SPECIFIC:</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="comment"># The last field in the list of field_identifiers is F22, so this gives</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="comment"># us the index into the token list where F22 starts, all tokens including</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="comment"># this one up to the end of the token list are all F22 fields.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="comment"># Get the start index of field 22 in the original message</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                f22_start_index = tokens.get_token_at(f22_index).get_token_start_index()</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="comment"># Get the end index of field 22 in the original message</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                f22_end_index = tokens.get_token_at(len(tokens.get_tokens()) - 1).get_token_end_index()</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="comment"># Retrieve the F22 string from the original message</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                f22_concatenated = flight_plan_record.get_message_body()[f22_start_index - 1:f22_end_index]</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="comment"># Save the field 22 string to the field 22 token along with its start and end index</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                tokens.get_token_at(f22_index).set_token_string(f22_concatenated)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                tokens.get_token_at(f22_index).set_token_start_index(f22_start_index)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                tokens.get_token_at(f22_index).set_token_end_index(f22_end_index)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="comment"># Lop off the remainder of the list</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                tokens.remove_tokens_from_end_of_list(f22_index)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">for</span> field_parser <span class="keywordflow">in</span> field_parsers:</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment"># Save the field to be parsed to the flight plan</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                flight_plan_record.add_icao_field(</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    field_identifiers[idx],</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    tokens.get_token_at(idx).get_token_string(),</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    tokens.get_token_at(idx).get_token_start_index() + len(flight_plan_record.get_message_header()),</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    tokens.get_token_at(idx).get_token_end_index() + len(flight_plan_record.get_message_header()))</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="comment"># Get the appropriate field parser</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                fp = field_parser(flight_plan_record, self.SFIF, self.SFD)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="comment"># Parse the field</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                fp.parse_field()</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                idx += 1</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="comment"># Check if we have more fields to parse than defined for this message</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordflow">if</span> tokens.get_number_of_tokens() &gt; md.get_number_of_fields_in_message():</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                Utils.add_error(flight_plan_record, tokens.get_token_at(idx).get_token_string(),</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                tokens.get_token_at(idx).get_token_start_index(),</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                tokens.get_token_at(idx).get_token_end_index(), self.EM,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                ErrorId.MSG_TOO_MANY_FIELDS)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">return</span> flight_plan_record.errors_detected()</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a97e87f0925994a34e7b4d3683dc56722"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e87f0925994a34e7b4d3683dc56722">&#9670;&nbsp;</a></span>parse_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_message </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method is the entry point for message parsing; the method takes an instance of FlightPlanRecord
(for output) and a string containing the message to parse. The FlightPlanRecord is populated by the
parser and includes all extracted fields, (if field 15 was present) is stored along with any route
extraction any errors. It is a callers responsibility to retrieve the errors.

:param flight_plan_record: A flight plan record into which all data extracted by the parser
       (including errors) are written;
:param message: The message with or without header;
:return: False if errors are detected, True otherwise;
</pre> <div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keyword">def </span>parse_message(self, flight_plan_record, message):</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str | None) -&gt; bool</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method is the entry point for message parsing; the method takes an instance of FlightPlanRecord</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">        (for output) and a string containing the message to parse. The FlightPlanRecord is populated by the</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">        parser and includes all extracted fields, (if field 15 was present) is stored along with any route</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral">        extraction any errors. It is a callers responsibility to retrieve the errors.</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">        :param flight_plan_record: A flight plan record into which all data extracted by the parser</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">               (including errors) are written;</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">        :param message: The message with or without header;</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">        :return: False if errors are detected, True otherwise;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment"># Check if the message is worthy of further processing</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.is_message_valid(flight_plan_record, message):</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment"># Save the complete message to the FPR</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        flight_plan_record.set_message_complete(message)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="comment"># Split and save the message header and body</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        self.set_message_body_and_header(flight_plan_record)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment"># Go into more detail and establish the message type;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment"># (ICAO ATS, OLDI or ADEXP). The message type is stored in the FPR.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.set_message_type(flight_plan_record):</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="comment"># Call the appropriate parser</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        match flight_plan_record.get_message_type():</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            case MessageTypes.ADEXP:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                self.parse_ats_header(flight_plan_record)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="keywordflow">return</span> self.parse_adexp(flight_plan_record)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            case MessageTypes.ATS:</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                self.parse_ats_header(flight_plan_record)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                self.parse_ats(flight_plan_record)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            case MessageTypes.OLDI:</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                self.parse_oldi_header(flight_plan_record)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                self.parse_oldi(flight_plan_record)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            case MessageTypes.UNKNOWN:</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment"># Call the consistency checking routines</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        self.consistency_check(flight_plan_record)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment"># Correct the Extracted route start and end indices to reference them against the message as a whole</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        self.correct_ers_indices(flight_plan_record)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">return</span> <span class="keywordflow">not</span> (flight_plan_record.errors_detected() <span class="keywordflow">or</span> len(flight_plan_record.get_erroneous_fields()))</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a13fbcfdb57c18c5e51ebaef3a475191f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13fbcfdb57c18c5e51ebaef3a475191f">&#9670;&nbsp;</a></span>parse_oldi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_oldi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This class parses an OLDI message. The difference between an ATS and OLDI message is that
the field list, i.e. the content of a given message based on its title, varies depending on the
adjacent unit that a message is being exchanged on.

This method calls the F3 parser which establishes the adjacent unit from F3b and sets this in
the FPR. The 'standard' ATS parser is then called which uses the adjacent unit to obtain the
correct field content definition.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if no errors were detected, False otherwise;
</pre> <div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keyword">def </span>parse_oldi(self, flight_plan_record):</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This class parses an OLDI message. The difference between an ATS and OLDI message is that</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="stringliteral">        the field list, i.e. the content of a given message based on its title, varies depending on the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="stringliteral">        adjacent unit that a message is being exchanged on.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="stringliteral">        This method calls the F3 parser which establishes the adjacent unit from F3b and sets this in</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="stringliteral">        the FPR. The &#39;standard&#39; ATS parser is then called which uses the adjacent unit to obtain the</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="stringliteral">        correct field content definition.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="stringliteral">        :return: True if no errors were detected, False otherwise;</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment"># Tokenize the message, open &amp; closed brackets will be removed</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        tokens = self.tokenize_message(flight_plan_record, <span class="stringliteral">&quot;()-\r\n\t&quot;</span>)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment"># Get the message title enumeration</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        message_title = Utils.title_defined(</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            tokens.get_first_token().get_token_string().replace(<span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>)[0:3])</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="comment"># For OLDI messages we need to establish the adjacent unit sender name</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment"># To do this we must assume that the first token is F3a and at least F3b.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment"># F3b contains the sender unit name. If we parse F3 it will set the</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment"># adjacent unit name into the FPR so that the appropriate field list can be</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="comment"># obtained for the OLDI title/unit.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment"># Set F3 to the FPR</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        flight_plan_record.add_icao_field(FieldIdentifiers.F3,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                          tokens.get_first_token().get_token_string(),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                          tokens.get_first_token().get_token_start_index(),</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                          tokens.get_first_token().get_token_end_index())</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment"># Parse F3, this will assign the adjacent unit name to the FPR</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        ParseF3(flight_plan_record, self.SFIF, self.SFD).parse_field()</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">return</span> self.parse_ats_or_oldi(flight_plan_record, tokens, message_title)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8649c4435e0efea774a2a2e8139b9cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8649c4435e0efea774a2a2e8139b9cf2">&#9670;&nbsp;</a></span>parse_oldi_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.parse_oldi_header </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keyword">def </span>parse_oldi_header(flight_plan_record):</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">if</span> flight_plan_record.get_message_body() == <span class="stringliteral">&quot;&quot;</span>:</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a61af25fe26dae1209cdd46e8a31fc0ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61af25fe26dae1209cdd46e8a31fc0ef">&#9670;&nbsp;</a></span>set_message_body_and_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.set_message_body_and_header </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method determines if a message contains a header and message body or if it's a message
without a header. The message header and body are copied to the FPR if they are present.

Differentiating between the message header and body is achieved by detecting the presence or not
of the first hyphen or open bracket in a message. The action taken is as per the following truth table:
   Open     Hyphen '-'
 Hyphen | Bracket |  Before |
Present | Present | Bracket | Action
--------+---------+---------+--------------------------------------------
   No   |    No   |    x    | Save to message body + Process, no header
--------+---------+---------+--------------------------------------------
   No   |   Yes   |    x    | Split on Bracket, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |    No   |    x    | Split on Hyphen, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |   Yes   |   No    | Split on Bracket, save to body and header + Process
--------+---------+---------+--------------------------------------------
  Yes   |   Yes   |  Yes    | Split on Hyphen, save to body and header + Process
--------+---------+---------+--------------------------------------------

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if the message header and body have been identified and stored, False if
 any errors were detected.
</pre> <div class="fragment"><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keyword">def </span>set_message_body_and_header(self, flight_plan_record):</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; None</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method determines if a message contains a header and message body or if it&#39;s a message</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">        without a header. The message header and body are copied to the FPR if they are present.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">        Differentiating between the message header and body is achieved by detecting the presence or not</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">        of the first hyphen or open bracket in a message. The action taken is as per the following truth table:</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">                   Open     Hyphen &#39;-&#39;</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">         Hyphen | Bracket |  Before |</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">        Present | Present | Bracket | Action</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral">           No   |    No   |    x    | Save to message body + Process, no header</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">           No   |   Yes   |    x    | Split on Bracket, save to body and header + Process</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">          Yes   |    No   |    x    | Split on Hyphen, save to body and header + Process</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">          Yes   |   Yes   |   No    | Split on Bracket, save to body and header + Process</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">          Yes   |   Yes   |  Yes    | Split on Hyphen, save to body and header + Process</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">        --------+---------+---------+--------------------------------------------</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse;</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">        :return: True if the message header and body have been identified and stored, False if</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">                 any errors were detected.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        msg = flight_plan_record.get_message_complete()</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="comment"># Get the indices of the two characters that could indicate the start</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="comment"># of the message body.</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        hyphen_index = msg.find(<span class="stringliteral">&quot;-&quot;</span>, 0, len(msg))</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        open_b_index = msg.find(<span class="stringliteral">&quot;(&quot;</span>, 0, len(msg))</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment"># Take action as described in the table for this methods&#39; documentation.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">if</span> hyphen_index &lt; 0 <span class="keywordflow">and</span> open_b_index &lt; 0:</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="comment"># Hyphen and Bracket Missing</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="comment"># A LAM has no hyphen, and if a message was submitted without a bracket, then...</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="comment"># Row 1 of the table in the comments</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            flight_plan_record.set_message_header(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            flight_plan_record.set_message_body(msg)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">elif</span> (hyphen_index &lt; 0 <span class="keywordflow">and</span> open_b_index &gt; -1) <span class="keywordflow">or</span> \</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                ((hyphen_index &gt; -1 <span class="keywordflow">and</span> open_b_index &gt; -1) <span class="keywordflow">and</span> open_b_index &lt; hyphen_index):</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="comment"># (Hyphen missing, open bracket present) or</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="comment"># ((Hyphen and bracket present) and Bracket before Hyphen)</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="comment"># Rows 2 &amp; 4 of the table in the comments</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment"># Split on bracket</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">if</span> open_b_index &lt; self.MINIMUM_HEADER_LENGTH:</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                flight_plan_record.set_message_header(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                flight_plan_record.set_message_body(msg)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                flight_plan_record.set_message_header(msg[0:open_b_index])</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                flight_plan_record.set_message_body(msg[open_b_index:])</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="comment"># (Hyphen present, open bracket missing) or</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="comment"># ((Hyphen and bracket present) and Hyphen before Bracket)</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="comment"># Rows 3 &amp; 5 of the table in the comments</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="comment"># Split on hyphen</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordflow">if</span> hyphen_index &lt; self.MINIMUM_HEADER_LENGTH:</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="comment"># Safe to assume there is no header</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                flight_plan_record.set_message_header(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                flight_plan_record.set_message_body(msg)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                flight_plan_record.set_message_header(msg[0:hyphen_index])</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                flight_plan_record.set_message_body(msg[hyphen_index:])</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="aff3ad13bc6a6afb7aeeb8e3761e8061e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff3ad13bc6a6afb7aeeb8e3761e8061e">&#9670;&nbsp;</a></span>set_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.set_message_type </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method sets the message type (ICAO ATS, OLDI or ADEXP) to the FPR. When this method
is called, the FPR contains a message body and maybe a header (if the message included a header).
This method recovers the message title from the start of the message body, and checks if it is a
supported message title. Using the title, the message type can be ascertained and set with one
of the enumeration values from the MessageDescriptions.MessageTypes class.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:return: True if a supported message title could be identified. False if any errors were detected.
</pre> <div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keyword">def </span>set_message_type(self, flight_plan_record):</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="comment"># type: (FlightPlanRecord) -&gt; bool</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method sets the message type (ICAO ATS, OLDI or ADEXP) to the FPR. When this method</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">        is called, the FPR contains a message body and maybe a header (if the message included a header).</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral">        This method recovers the message title from the start of the message body, and checks if it is a</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="stringliteral">        supported message title. Using the title, the message type can be ascertained and set with one</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">        of the enumeration values from the MessageDescriptions.MessageTypes class.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse;</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">        :return: True if a supported message title could be identified. False if any errors were detected.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        msg_body = flight_plan_record.get_message_body()</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        msg_header = flight_plan_record.get_message_header()</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment"># If we can find the &#39;-TITLE&#39; in some shape or form at the start</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment"># of the field, we must have an ADEXP message.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment"># Regexp is for e.g &#39;   -   TITLE&#39; -&gt; whitespace irrelevant</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">if</span> re.match(<span class="stringliteral">&quot;[ \n\r\t]*-[ \n\r\t]*TITLE&quot;</span>, msg_body) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="comment"># We have an ADEXP message</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;&quot;</span>, 0, 0, self.EM, ErrorId.MSG_ADEXP_NOT_SUPPORTED)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            flight_plan_record.set_message_type(MessageTypes.ADEXP)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="comment"># Try and locate an ATS message title, first attempt with a bracket</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment"># Regexp is for e.g &#39;   (   FPL&#39; Bracket is optional, whitespace irrelevant</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        f3 = re.match(<span class="stringliteral">&quot;[ \n\r\t]*[(]?[ \n\r\t]*[A-Z]{3}&quot;</span>, msg_body)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">if</span> f3 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="comment"># Message title not recognised, error, grab the first three characters</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            m = re.match(<span class="stringliteral">&quot;.{3}&quot;</span>, msg_body)</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            Utils.add_error(flight_plan_record, m.group(0),</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                            len(msg_header) + m.span()[1] - 3,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                            len(msg_header) + m.span()[1], self.EM, ErrorId.F3_TITLE_SYNTAX)</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="comment"># Store the indices for future error reporting.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        end_index = len(msg_header) + f3.span()[1]</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        start_index = end_index - 3</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="comment"># We have a possible ATS message, extract the message title</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        f3 = re.findall(<span class="stringliteral">&quot;[A-Z]{3}&quot;</span>, f3.group(0))</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keywordflow">if</span> f3 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="comment"># Try and figure out the message type</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            message_type = self.determine_message_type(f3[0])</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">if</span> message_type <span class="keywordflow">is</span> MessageTypes.UNKNOWN:</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <span class="comment"># Unrecognised message title</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                Utils.add_error(flight_plan_record, f3[0], start_index, end_index + 3,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                self.EM, ErrorId.F3_TITLE_SYNTAX)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="comment"># Title recognized</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <span class="comment"># One more check to do, some message titles are the same for</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                <span class="comment"># OLDI and ATS messages. OLDI messages always include F3b &amp; F3c.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="comment"># Regexp is for e.g &#39;   (   ACPAA/BB001&#39; Bracket is optional, whitespace irrelevant</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                mm = re.match(<span class="stringliteral">&quot;[ \n\r\t]*[(]?[ \n\r\t]*[A-Z]{3,7}/[A-Z]{1,4}[0-9]{1,3}&quot;</span>, msg_body)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                message_title = Utils.title_defined(f3[0])</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                <span class="keywordflow">if</span> (message_title <span class="keywordflow">is</span> MessageTitles.ACP <span class="keywordflow">or</span> message_title <span class="keywordflow">is</span> MessageTitles.CDN <span class="keywordflow">or</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        message_title <span class="keywordflow">is</span> MessageTitles.CPL) <span class="keywordflow">and</span> mm <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    flight_plan_record.set_message_type(MessageTypes.OLDI)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    flight_plan_record.set_message_type(message_type)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="comment"># This should never ever happen</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            Utils.add_error(flight_plan_record, <span class="stringliteral">&quot;Regexp went wrong&quot;</span>, 0, 0, self.EM, ErrorId.F3_TITLE_SYNTAX)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            flight_plan_record.set_message_type(MessageTypes.UNKNOWN)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e3dc036d0345524348c5144b438055d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e3dc036d0345524348c5144b438055d">&#9670;&nbsp;</a></span>tokenize_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def IcaoMessageParser.ParseMessage.ParseMessage.tokenize_message </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flight_plan_record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whitespace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">This method tokenizes a field or message based on the token separators in the parameter
'whitespace'.

:param flight_plan_record: The Flight Plan Record containing the message to parse;
:param whitespace: The whitespace characters used to delimit the tokens, these are all consumed by
       the parser apart from the forward slash character '/' which results in its own token.
:return: The list of tokens;
</pre> <div class="fragment"><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keyword">def </span>tokenize_message(flight_plan_record, whitespace):</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment"># type: (FlightPlanRecord, str) -&gt; Tokens</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;This method tokenizes a field or message based on the token separators in the parameter</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral">        &#39;whitespace&#39;.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">        :param flight_plan_record: The Flight Plan Record containing the message to parse;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="stringliteral">        :param whitespace: The whitespace characters used to delimit the tokens, these are all consumed by</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="stringliteral">               the parser apart from the forward slash character &#39;/&#39; which results in its own token.</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="stringliteral">        :return: The list of tokens;</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        tokenizer = Tokenize()</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        tokenizer.set_string_to_tokenize(flight_plan_record.get_message_body())</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        tokenizer.set_whitespace(whitespace)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        tokenizer.tokenize()</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">return</span> tokenizer.get_tokens()</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac9f430a4912db205f3371bd0561b4b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f430a4912db205f3371bd0561b4b39">&#9670;&nbsp;</a></span>ErrorMessages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IcaoMessageParser.ParseMessage.ParseMessage.ErrorMessages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0979c9d10b2856a1a424965c14898e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0979c9d10b2856a1a424965c14898e8e">&#9670;&nbsp;</a></span>FieldsInMessage</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IcaoMessageParser.ParseMessage.ParseMessage.FieldsInMessage</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a92f2c99a719bd6a23f3ca2755f576641"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f2c99a719bd6a23f3ca2755f576641">&#9670;&nbsp;</a></span>int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IcaoMessageParser.ParseMessage.ParseMessage.int</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64bd0c972c9e1e5a9ab6c765f770c05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64bd0c972c9e1e5a9ab6c765f770c05b">&#9670;&nbsp;</a></span>SubFieldDescriptions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IcaoMessageParser.ParseMessage.ParseMessage.SubFieldDescriptions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c65544aeab4f892da49ca1d4bd617fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c65544aeab4f892da49ca1d4bd617fb">&#9670;&nbsp;</a></span>SubFieldsInFields</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IcaoMessageParser.ParseMessage.ParseMessage.SubFieldsInFields</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>IcaoMessageParser/<a class="el" href="ParseMessage_8py.html">ParseMessage.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceIcaoMessageParser.html">IcaoMessageParser</a></li><li class="navelem"><a class="el" href="namespaceIcaoMessageParser_1_1ParseMessage.html">ParseMessage</a></li><li class="navelem"><a class="el" href="classIcaoMessageParser_1_1ParseMessage_1_1ParseMessage.html">ParseMessage</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
